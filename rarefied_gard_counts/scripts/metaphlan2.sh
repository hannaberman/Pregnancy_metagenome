#!/bin/bash
#SBATCH -o /home6/hlberman/VMMG/rarefied_gard_counts/log/metaphlan2_%j.out

in_path=/home6/hlberman/VMMG/rarefied_gard_counts/rarefied_samples
out_path=/home6/hlberman/VMMG/rarefied_gard_counts/metaphlan2_outs
metaphlan_tmp=/home6/hlberman/VMMG/rarefied_gard_counts/metaphlan_tmp

# samples
declare -a arr=(
#stanford and uab samples
#1000801248
#1000801318
1000801368
1001301158
1001301248
1001301318
1001801138
1001801248
1001801318
1002701138
1002701158
1002701278
1003101118
1003101188
1003101278
1004001168
1004001278
1004001348
1005601098
1005601168
1005601348
1050801308
1050801318
1050835178
1050835218
1060435158
1060435318
1060435348
1060801198
1060801338
1060835148
1061235118
1061235188
1061235278
1061635088
1061635208
1061635368
1062101108
1062101238
1062101338
1062301128
1062301198
1062335178
1062601228
1062601258
1062601368
1062701128
1062701298
1062735148
1062735198
1062901138
1062901218
1062901318
1900401198
1900401288
1900401398
1902401118
1902401208
1902401308
2050501168
2050501298
2050501348
4002101198
4002101298
4002135018
4003235018
4003235288
4003235368
4004235208
4004235248
4004235268
4004735328
4004735368
4004935158
4004935268
4004935338
4005935278
4005935328
4005935358
4006635198
4006635258
4006635278
4006635338
4006935208
4006935248
4006935358
4007135108
4007135118
4007135148
4007135288
4007235168
4007235278
4007435168
4007435248
4007435258
4007535198
4007535238
4007535358
4008435158
4008435348
4008435358
4009035168
4009035268
4009035368
4009835178
4009835228
4009835268
#hmp2 samples
SRR6743909
SRR6743910
SRR6743911
SRR6743912
SRR6743913
SRR6743914
SRR6743915
SRR6743916
SRR6743917
SRR6743918
SRR6743919
SRR6743921
SRR6743922
SRR6743923
SRR6743926
SRR6743928
SRR6743929
SRR6743931
SRR6743932
SRR6743934
SRR6743935
SRR6743937
SRR6743939
SRR6743940
SRR6743941
SRR6743942
SRR6743944
SRR6743945
SRR6743947
SRR6743948
SRR6743951
SRR6743952
SRR6743953
SRR6743954
SRR6743955
SRR6743956
SRR6743957
SRR6743958
SRR6743959
SRR6743961
SRR6743962
SRR6743963
SRR6743964
SRR6743969
SRR6743970
SRR6743972
SRR6743973
SRR6743976
SRR6743980
SRR6743982
SRR6743983
SRR6743985
SRR6743986
SRR6743987
SRR6743988
SRR6743989
SRR6743991
SRR6743992
SRR6743994
SRR6743997
SRR6743998
SRR6743999
SRR6744000
SRR6744001
SRR6744002
SRR6744003
SRR6744004
SRR6744005
SRR6744006
SRR6744007
SRR6744008
SRR6744009
SRR6744010
SRR6744011
SRR6744012
SRR6744014
SRR6744015
SRR6744016
SRR6744017
SRR6744019
SRR6744020
SRR6744022
SRR6744023
SRR6744025
SRR6744027
SRR6744028
SRR6744031
SRR6744033
SRR6744034
SRR6744036
SRR6744037
SRR6744039
SRR6744040
SRR6744041
SRR6744042
SRR6744043
SRR6744044
SRR6744045
SRR6744046
SRR6744048
SRR6744049
SRR6744050
SRR6744051
SRR6744052
SRR6744053
SRR6744054
SRR6744061
SRR6744062
SRR6744063
SRR6744064
SRR6744065
SRR6744066
SRR6744067
SRR6744068
SRR6744069
SRR6744070
SRR6744071
SRR6744072
SRR6744073
SRR6744076
SRR6744077
SRR6744078
SRR6744079
SRR6744080
SRR6744081
SRR6744082
SRR6744083
SRR6744084
SRR6744085
SRR6744088
SRR6744089
SRR6744090
SRR6744091
SRR6744093
SRR6744096
SRR6744100
SRR6744102
SRR6744103
SRR6744104
SRR6744106
SRR6744110
SRR6744111
SRR6744112
SRR6744113
SRR6744115
SRR6744117
SRR6744118
SRR6744119
SRR6744120
SRR6744123
SRR6744124
SRR6744127
SRR6744128
SRR6744129
SRR6744130
SRR6744131
SRR6744132
SRR6744135
SRR6744136
SRR6744137
SRR6744138
SRR6744140
SRR6744143
SRR6744145
SRR6744147
SRR6744149
SRR6744150
SRR6744153
SRR6744155
SRR6744158
SRR6744159
SRR6744160
SRR6744161
SRR6744162
SRR6744163
SRR6744165
SRR6744167
SRR6744168
SRR6744171
SRR6744174
SRR6744175
SRR6744177
SRR6744178
SRR6744179
SRR6744180
SRR6744181
SRR6744182
SRR6744183
SRR6744184
SRR6744185
SRR6744186
SRR6744187
SRR6744189
SRR6744190
SRR6744191
SRR6744193
SRR6744194
SRR6744195
SRR6744197
SRR6744198
SRR6744199
SRR6744201
SRR6744203
SRR6744204
SRR6744205
SRR6744210
SRR6744211
SRR6744212
SRR6744213
SRR6744214
SRR6744215
SRR6744216
SRR6744217
SRR6744220
SRR6744221
SRR6744222
SRR6744223
SRR6744224
SRR6744225
SRR6744226
SRR6744227
SRR6744228
SRR6744230
SRR6744233
SRR6744234
SRR6744235
SRR6744236
SRR6744237
SRR6744239
SRR6744241
SRR6744243
SRR6744245
SRR6744247
SRR6744249
SRR6744251
SRR6744252
SRR6744253
SRR6744255
SRR6744256
SRR6744259
SRR6744263
SRR6744266
SRR6744268
SRR6744269
SRR6744271
SRR6744272
SRR6744273
SRR6744275
SRR6744280
SRR6744281
SRR6744283
SRR6744284
SRR6744285
SRR6744286
SRR6744287
SRR6744289
SRR6744290
SRR6744292
SRR6744293
SRR6744294
SRR6744296
SRR6744298
SRR6744299
SRR6744300
SRR6744301
SRR6744302
SRR6744306
SRR6744307
SRR6744309
SRR6744310
SRR6744311
SRR6744312
SRR6744314
SRR6744316
SRR6744317
SRR6744318
SRR6744320
SRR6744321
SRR6744323
SRR6744324
SRR6744325
SRR6744327
SRR6744328
SRR6744330
SRR6744332
SRR6744333
SRR6744334
SRR6744336
SRR6744337
SRR6744340
SRR6744341
SRR6744344
SRR6744345
SRR6744346
SRR6744347
SRR6744348
SRR6744349
SRR6744350
SRR6744351
SRR6744352
SRR6744354
SRR6744355
SRR6744357
SRR6744358
SRR6744359
SRR6744362
SRR6744363
SRR6744364
SRR6744368
SRR6744369
SRR6744372
SRR6744373
SRR6744374
SRR6744375
SRR6744377
SRR6744379
SRR6744380
SRR6744382
SRR6744383
SRR6744384
SRR6744385
SRR6744386
SRR6744387
SRR6744388
SRR6744389
SRR6744392
SRR6744394
SRR6744395
SRR6744396
SRR6744397
SRR6744398
SRR6744399
SRR6744400
SRR6744402
SRR6744404
SRR6744406
SRR6744407
SRR6744409
SRR6744410
SRR6744411
SRR6744412
SRR6744413
SRR6744414
SRR6744416
SRR6744417
SRR6744418
SRR6744419
SRR6744420
SRR6744424
SRR6744425
SRR6744426
SRR6744427
SRR6744428
SRR6744430
SRR6744433
SRR6744435
SRR6744437
SRR6744438
SRR6744439
SRR6744440
SRR6744447
SRR6744449
SRR6744450
SRR6744451
SRR6744452
SRR6744453
SRR6744456
SRR6744457
SRR6744459
SRR6744462
SRR6744463
SRR6744466
SRR6744467
SRR6744469
SRR6744472
SRR6744473
SRR6744474
SRR6744475
SRR6744478
SRR6744479
SRR6744483
SRR6744486
SRR6744489
SRR6744491
SRR6744492
SRR6744493
SRR6744494
SRR6744495
SRR6744496
SRR6744498
SRR6744500
SRR6744502
SRR6744503
SRR6744504
SRR6744505
SRR6744506
SRR6744508
SRR6744509
SRR6744510
SRR6744511
SRR6744512
SRR6744513
SRR6744514
SRR6744515
SRR6744516
SRR6744520
SRR6744522
SRR6744524
SRR6744525
SRR6744526
SRR6744527
SRR6744531
SRR6744532
SRR6744533
SRR6744534
SRR6744536
SRR6744537
SRR6744538
SRR6744540
SRR6744541
SRR6744542
SRR6744543
SRR6744544
SRR6744545
SRR6744548
SRR6744549
SRR6744550
SRR6744551
SRR6744552
SRR6744554
SRR6744555
SRR6744556
SRR6744557
SRR6744558
SRR6744559
SRR6744560
SRR6744561
SRR6744566
SRR6744568
SRR6744569
SRR6744570
SRR6744572
SRR6744573
SRR6744575
SRR6744577
SRR6744579
SRR6744580
SRR6744582
SRR6744583
SRR6744586
SRR6744587
SRR6744588
SRR6744589
SRR6744590
SRR6744591
SRR6744594
SRR6744596
SRR6744597
SRR6744602
SRR6744604
SRR6744605
SRR6744607
SRR6744608
SRR6744610
SRR6744612
SRR6744614
SRR6744615
SRR6744617
SRR6744618
SRR6744621
SRR6744622
SRR6744624
SRR6744626
SRR6744627
SRR6744628
SRR6744631
SRR6744633
SRR6744634
SRR6744637
SRR6744640
SRR6744642
SRR6744643
SRR6744644
SRR6744645
SRR6744646
SRR6744647
SRR6744648
SRR6744650
SRR6744651
SRR6744652
SRR6744654
SRR6744655
SRR6744657
SRR6744659
SRR6744660
SRR6744661
SRR6744662
SRR6744666
SRR6744668
SRR6744670
SRR6744672
SRR6744675
SRR6744676
SRR6744677
SRR6744678
SRR6744681
SRR6744682
SRR6744683
SRR6744686
SRR6744687
SRR6744688
SRR6744690
SRR6744692
SRR6744693
SRR6744694
SRR6744697
SRR6744698
SRR6744699
SRR6744700
SRR6744703
SRR6744704
SRR6744706
SRR6744709
SRR6744711
SRR6744712
SRR6744714
SRR6744715
SRR6744716
SRR6744717
SRR6744719
SRR6744720
SRR6744721
SRR6744722
SRR6744724
SRR6744725
SRR6744727
SRR6744728
SRR6744730
SRR6744732
SRR6744734
SRR6744736
SRR6744737
SRR6744738
SRR6744740
SRR6744741
SRR6744742
SRR6744743
SRR6744744
SRR6744746
SRR6744748
SRR6744750
SRR6744751
SRR6744752
SRR6744753
SRR6744754
SRR6744755
SRR6744757
SRR6744761
SRR6744762
SRR6744763
SRR6744764
SRR6744765
SRR6744767
SRR6744768
SRR6744769
SRR6744771
SRR6744772
SRR6744773
SRR6744774
SRR6744775
SRR6744776
SRR6744781
SRR6744782
SRR6744784
SRR6744785
SRR6744786
SRR6744787
SRR6744788
SRR6744789
SRR6744791
SRR6744792
SRR6744795
SRR6744797
SRR6744798
SRR6744799
SRR6744801
SRR6744802
SRR6744806
SRR6744807
SRR6744808
SRR6744812
SRR6744813
SRR6744814
SRR6744816
SRR6744817
SRR6744818
SRR6744820
SRR6744821
SRR6744822
SRR6744823
SRR6744824
SRR6744825
SRR6744827
SRR6744828
SRR6744830
SRR6744834
SRR6744836
SRR6744837
SRR6744838
SRR6744839
SRR6744841
SRR6744843
SRR6744844
SRR6744845
SRR6744846
SRR6744847
SRR6744848
SRR6744849
SRR6744850
SRR6744851
SRR6744852
SRR6744853
SRR6744854
SRR6744855
SRR6744856
SRR6744857
SRR6744861
SRR6744863
SRR6744864
SRR6744865
SRR6744867
SRR6744868
SRR6744869
SRR6744870
SRR6744871
SRR6744872
SRR6744873
SRR6744874
SRR6744876
SRR6744879
SRR6744880
SRR6744881
SRR6744882
SRR6744885
SRR6744886
SRR6744887
SRR6744888
SRR6744891
SRR6744892
SRR6744893
SRR6744895
SRR6744899
SRR6744900
SRR6744903
SRR6744904
SRR6744905
SRR6744906
SRR6744907
SRR6744908
SRR6744909
SRR6744910
SRR6744911
SRR6744912
SRR6744913
SRR6744919
SRR6744921
SRR6744922
SRR6744923
SRR6744924
SRR6744927
SRR6744929
SRR6744932
SRR6744933
SRR6744934
SRR6744936
SRR6744937
SRR6744938
SRR6744939
SRR6744942
SRR6744943
SRR6744944
SRR6744946
SRR6744947
SRR6744948
SRR6744950
SRR6744951
SRR6744952
SRR6744953
SRR6744954
SRR6744956
SRR6744957
SRR6744958
SRR6744959
SRR6744960
SRR6744963
SRR6744964
SRR6744965
SRR6744966
SRR6744967
SRR6744968
SRR6744969
SRR6744970
SRR6744974
SRR6744975
SRR6744978
SRR6744979
SRR6744983
SRR6744984
SRR6744987
SRR6744988
SRR6744989
SRR6744990
SRR6744993
SRR6744994
SRR6744995
SRR6744996
SRR6744997
SRR6745000
SRR6745002
SRR6745003
SRR6745006
SRR6745007
SRR6745008
SRR6745009
SRR6745010
SRR6745011
SRR6745013
SRR6745014
SRR6745017
SRR6745018
SRR6745019
SRR6745021
SRR6745022
SRR6745023
SRR6745024
SRR6745025
SRR6745027
SRR6745028
SRR6745029
SRR6745030
SRR6745031
SRR6745033
SRR6745034
SRR6745035
SRR6745036
SRR6745037
SRR6745038
SRR6745039
SRR6745040
SRR6745041
SRR6745042
SRR6745043
SRR6745046
SRR6745047
SRR6745048
SRR6745050
SRR6745051
SRR6745052
SRR6745053
SRR6745056
SRR6745057
SRR6745059
SRR6745060
SRR6745061
SRR6745062
SRR6745063
SRR6745064
SRR6745065
SRR6745066
SRR6745069
SRR6745070
SRR6745071
SRR6745072
SRR6745073
SRR6745074
SRR6745075
SRR6745076
SRR6745077
SRR6745078
SRR6745079
SRR6745080
SRR6745081
SRR6745082
SRR6745085
SRR6745088
SRR6745089
SRR6745090
SRR6745091
SRR6745092
SRR6745093
SRR6745094
SRR6745095
SRR6745096
SRR6745097
SRR6745099
SRR6745101
SRR6745102
SRR6745103
SRR6745104
SRR6745110
SRR6745111
SRR6745112
SRR6745113
SRR6745114
SRR6745115
SRR6745116
SRR6745120
SRR6745121
SRR6745123
SRR6745124
SRR6745125
SRR6745126
SRR6745127
SRR6745128
SRR6745130
SRR6745131
SRR6745132
SRR6745133
SRR6745135
SRR6745136
SRR6745137
SRR6745141
SRR6745143
SRR6745144
SRR6745145
SRR6745146
SRR6745147
SRR6745148
SRR6745149
SRR6745150
SRR6745151
SRR6745152
SRR6745153
SRR6745155
SRR6745158
SRR6745160
SRR6745162
SRR6745164
SRR6745166
SRR6745167
SRR6745168
SRR6745170
SRR6745171
SRR6745172
SRR6745174
SRR6745175
SRR6745176
SRR6745177
SRR6745178
SRR6745181
SRR6745183
SRR6745184
SRR6745186
SRR6745187
SRR6745188
SRR6745189
SRR6745190
SRR6745191
SRR6745192
SRR6745194
SRR6745195
SRR6745197
SRR6745198
SRR6745199
SRR6745200
SRR6745202
SRR6745204
SRR6745205
SRR6745208
SRR6745209
SRR6745211
SRR6745212
SRR6745213
SRR6745214
SRR6745215
SRR6745216
SRR6745217
SRR6745218
SRR6745219
SRR6745220
SRR6745221
SRR6745223
SRR6745224
SRR6745225
SRR6745226
SRR6745227
SRR6745228
SRR6745230
SRR6745231
SRR6745233
SRR6745234
SRR6745235
SRR6745236
SRR6745239
SRR6745240
SRR6745241
SRR6745244
SRR6745245
SRR6745246
SRR6745247
SRR6745248
SRR6745249
SRR6745250
SRR6745251
SRR6745253
SRR6745254
SRR6745255
SRR6745257
SRR6745258
SRR6745259
SRR6745261
SRR6745263
SRR6745264
SRR6745265
SRR6745266
SRR6745267
SRR6745268
SRR6745269
SRR6745271
SRR6745272
SRR6745273
SRR6745274
SRR6745275
SRR6745276
SRR6745278
SRR6745279
SRR6745280
SRR6745281
SRR6745282
SRR6745283
)

## now loop through the above array to filter Samples
for accession in "${arr[@]}"
do

/home6/hlberman/Applications/metaphlan2/metaphlan2.py \
    --input_type fastq \
    --bowtie2_exe /home6/hlberman/Applications/bowtie2-2.3.5/bowtie2 \
    --nproc 4 \
    --bowtie2out $metaphlan_tmp/${accession}.bowtie2.bz2 \
    $in_path/sub_${accession}_1.fastq.gz,$in_path/sub_${accession}_2.fastq.gz > $out_path/$accession.txt

#remove bowtie file
rm $metaphlan_tmp/${accession}.bowtie2.bz2

done