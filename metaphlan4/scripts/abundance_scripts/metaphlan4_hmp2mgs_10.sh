#!/bin/bash
#SBATCH -o /home6/hlberman/VMMG/metaphlan4/log/hmp2mgs_metaphlan4_10_%j.out
#SBATCH -c 8

reads_path=/home6/hlberman/VMMG/bbmap_human/hmp2mgs_filt_fastq/
out_path=/home6/hlberman/VMMG/metaphlan4/outputs/hmp2mgs_metaphlan/

# List SRA accessions
declare -a arr=(
SRR6744065
SRR6744266
SRR6744590
SRR6744143
SRR6743963
SRR6744655
SRR6744084
SRR6744344
SRR6743961
SRR6744222
SRR6744149
SRR6744438
SRR6743911
SRR6744963
SRR6744293
SRR6744932
SRR6744001
SRR6744302
SRR6744650
SRR6744522
SRR6744318
SRR6744843
SRR6744895
SRR6744228
SRR6744195
SRR6743954
SRR6743958
SRR6744089
SRR6744068
SRR6744398
SRR6744852
SRR6745000
SRR6744873
SRR6744556
SRR6744328
SRR6744016
SRR6744413
SRR6743926
SRR6744104
SRR6744193
SRR6744509
SRR6744198
SRR6744557
SRR6744002
SRR6744933
SRR6744011
SRR6744839
SRR6744389
SRR6744237
SRR6744205
SRR6744023
SRR6744096
SRR6744792
SRR6744651
SRR6744717
SRR6744750
SRR6744888
SRR6743916
SRR6743970
SRR6744923
SRR6744725
SRR6744722
SRR6744123
SRR6744550
SRR6743928
SRR6744730
SRR6744472
SRR6744959
SRR6744298
SRR6744666
SRR6744533
SRR6744494
SRR6744678
SRR6744124
SRR6744697
SRR6743997
SRR6744314
SRR6744161
SRR6744416
SRR6744049
SRR6744944
SRR6745002
SRR6743935
SRR6744614
SRR6744841
SRR6744175
SRR6744177
SRR6744892
SRR6744808
SRR6744711
SRR6744681
SRR6744984
SRR6744699
)


for accession in "${arr[@]}"
do
metaphlan \
    $reads_path/${accession}_1.fastq.gz,$reads_path/${accession}_2.fastq.gz \
    --input_type fastq \
    --nproc 8 \
    --index mpa_vOct22_CHOCOPhlAnSGB_202212 \
    --bowtie2db /home6/hlberman/Applications/metaphlan4/MetaPhlAn/metaphlan/metaphlan_databases/ \
    --bowtie2out $out_path/${accession}_metaphlan2_bowtie2.bz2  \
    -o $out_path/${accession}_metaphlan_bugs_list.tsv
done
