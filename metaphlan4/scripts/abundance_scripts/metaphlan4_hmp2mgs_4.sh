#!/bin/bash
#SBATCH -o /home6/hlberman/VMMG/metaphlan4/log/hmp2mgs_metaphlan4_4_%j.out
#SBATCH -c 8

reads_path=/home6/hlberman/VMMG/bbmap_human/hmp2mgs_filt_fastq/
out_path=/home6/hlberman/VMMG/metaphlan4/outputs/hmp2mgs_metaphlan/

# List SRA accessions
declare -a arr=(
SRR6744466
SRR6745195
SRR6744179
SRR6744525
SRR6745177
SRR6744993
SRR6745153
SRR6744575
SRR6745047
SRR6745191
SRR6745124
SRR6744996
SRR6745247
SRR6745219
SRR6745141
SRR6745227
SRR6744964
SRR6745010
SRR6744450
SRR6745092
SRR6744280
SRR6744387
SRR6744861
SRR6745211
SRR6743980
SRR6744307
SRR6744737
SRR6744844
SRR6744119
SRR6744662
SRR6745265
SRR6744847
SRR6745228
SRR6744704
SRR6745104
SRR6745204
SRR6744048
SRR6745073
SRR6745199
SRR6744427
SRR6744453
SRR6744163
SRR6745209
SRR6744111
SRR6744825
SRR6744063
SRR6744876
SRR6744798
SRR6744828
SRR6744536
SRR6744014
SRR6744045
SRR6743998
SRR6744909
SRR6744273
SRR6744948
SRR6744921
SRR6744527
SRR6744554
SRR6743951
SRR6744362
SRR6744560
SRR6744785
SRR6744506
SRR6744478
SRR6744983
SRR6745006
SRR6744088
SRR6744417
SRR6745271
SRR6745014
SRR6744113
SRR6744388
SRR6744714
SRR6745245
SRR6745113
SRR6744380
SRR6745261
SRR6744379
SRR6745249
SRR6744323
SRR6745200
SRR6744957
SRR6744269
SRR6744167
SRR6744755
SRR6744025
SRR6744290
SRR6745158
SRR6745226
SRR6744225
SRR6744891
SRR6744776
)


for accession in "${arr[@]}"
do
metaphlan \
    $reads_path/${accession}_1.fastq.gz,$reads_path/${accession}_2.fastq.gz \
    --input_type fastq \
    --nproc 8 \
    --index mpa_vOct22_CHOCOPhlAnSGB_202212 \
    --bowtie2db /home6/hlberman/Applications/metaphlan4/MetaPhlAn/metaphlan/metaphlan_databases/ \
    --bowtie2out $out_path/${accession}_metaphlan2_bowtie2.bz2  \
    -o $out_path/${accession}_metaphlan_bugs_list.tsv
done
