#!/bin/bash
#SBATCH -o /home6/hlberman/VMMG/metaphlan4/log/hmp2mgs_metaphlan4_8_%j.out
#SBATCH -c 8

reads_path=/home6/hlberman/VMMG/bbmap_human/hmp2mgs_filt_fastq/
out_path=/home6/hlberman/VMMG/metaphlan4/outputs/hmp2mgs_metaphlan/

# List SRA accessions
declare -a arr=(
SRR6744374
SRR6744306
SRR6744212
SRR6744428
SRR6743912
SRR6744364
SRR6744516
SRR6744740
SRR6744009
SRR6744672
SRR6744919
SRR6744327
SRR6744357
SRR6744426
SRR6744051
SRR6744511
SRR6744558
SRR6744660
SRR6744604
SRR6744194
SRR6744440
SRR6744004
SRR6743955
SRR6744763
SRR6744112
SRR6744818
SRR6745003
SRR6744083
SRR6744813
SRR6744042
SRR6744561
SRR6744479
SRR6744573
SRR6744255
SRR6744372
SRR6744137
SRR6744850
SRR6744191
SRR6744929
SRR6744688
SRR6744943
SRR6743909
SRR6744402
SRR6744974
SRR6744904
SRR6744615
SRR6743982
SRR6744741
SRR6744425
SRR6744834
SRR6744628
SRR6744827
SRR6744072
SRR6744734
SRR6744407
SRR6744552
SRR6744155
SRR6744978
SRR6744136
SRR6744712
SRR6744846
SRR6744346
SRR6743923
SRR6744120
SRR6744910
SRR6744586
SRR6744781
SRR6744081
SRR6744180
SRR6743919
SRR6744504
SRR6744199
SRR6744046
SRR6744171
SRR6744806
SRR6744757
SRR6744100
SRR6744210
SRR6744886
SRR6743972
SRR6744129
SRR6744159
SRR6744545
SRR6743987
SRR6744775
SRR6744836
SRR6744979
SRR6744110
SRR6744675
SRR6744622
SRR6744419
SRR6744706
SRR6744184
)


for accession in "${arr[@]}"
do
metaphlan \
    $reads_path/${accession}_1.fastq.gz,$reads_path/${accession}_2.fastq.gz \
    --input_type fastq \
    --nproc 8 \
    --index mpa_vOct22_CHOCOPhlAnSGB_202212 \
    --bowtie2db /home6/hlberman/Applications/metaphlan4/MetaPhlAn/metaphlan/metaphlan_databases/ \
    --bowtie2out $out_path/${accession}_metaphlan2_bowtie2.bz2  \
    -o $out_path/${accession}_metaphlan_bugs_list.tsv
done
