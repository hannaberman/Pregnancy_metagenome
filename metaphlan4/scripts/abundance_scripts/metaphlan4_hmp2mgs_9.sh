#!/bin/bash
#SBATCH -o /home6/hlberman/VMMG/metaphlan4/log/hmp2mgs_metaphlan4_9_%j.out
#SBATCH -c 8

reads_path=/home6/hlberman/VMMG/bbmap_human/hmp2mgs_filt_fastq/
out_path=/home6/hlberman/VMMG/metaphlan4/outputs/hmp2mgs_metaphlan/

# List SRA accessions
declare -a arr=(
SRR6744467
SRR6744582
SRR6744634
SRR6744864
SRR6744115
SRR6744540
SRR6744406
SRR6744015
SRR6744837
SRR6744907
SRR6744947
SRR6744281
SRR6744187
SRR6744871
SRR6744272
SRR6744400
SRR6744317
SRR6744090
SRR6744220
SRR6744189
SRR6744960
SRR6744995
SRR6744608
SRR6744310
SRR6744913
SRR6744767
SRR6744062
SRR6744358
SRR6744005
SRR6744970
SRR6744082
SRR6744147
SRR6744500
SRR6744320
SRR6744937
SRR6744569
SRR6744395
SRR6744430
SRR6744259
SRR6744899
SRR6744633
SRR6744596
SRR6744397
SRR6744869
SRR6744849
SRR6744838
SRR6744316
SRR6744325
SRR6744830
SRR6744885
SRR6744052
SRR6744721
SRR6744934
SRR6744165
SRR6744966
SRR6744856
SRR6744594
SRR6743940
SRR6744551
SRR6744000
SRR6744716
SRR6744782
SRR6744369
SRR6744646
SRR6744882
SRR6744867
SRR6744010
SRR6744537
SRR6744724
SRR6744872
SRR6744848
SRR6744079
SRR6744538
SRR6744459
SRR6744965
SRR6744602
SRR6744197
SRR6744383
SRR6743964
SRR6744621
SRR6744610
SRR6744473
SRR6744284
SRR6744053
SRR6744103
SRR6744337
SRR6744493
SRR6744659
SRR6743957
SRR6744324
SRR6744181
SRR6744879
SRR6744350
)


for accession in "${arr[@]}"
do
metaphlan \
    $reads_path/${accession}_1.fastq.gz,$reads_path/${accession}_2.fastq.gz \
    --input_type fastq \
    --nproc 8 \
    --index mpa_vOct22_CHOCOPhlAnSGB_202212 \
    --bowtie2db /home6/hlberman/Applications/metaphlan4/MetaPhlAn/metaphlan/metaphlan_databases/ \
    --bowtie2out $out_path/${accession}_metaphlan2_bowtie2.bz2  \
    -o $out_path/${accession}_metaphlan_bugs_list.tsv
done
