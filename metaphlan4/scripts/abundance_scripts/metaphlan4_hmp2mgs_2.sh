#!/bin/bash
#SBATCH -o /home6/hlberman/VMMG/metaphlan4/log/hmp2mgs_metaphlan4_2_%j.out
#SBATCH -c 8

reads_path=/home6/hlberman/VMMG/bbmap_human/hmp2mgs_filt_fastq/
out_path=/home6/hlberman/VMMG/metaphlan4/outputs/hmp2mgs_metaphlan/

# List SRA accessions
declare -a arr=(
SRR6745063
SRR6744868
SRR6744093
SRR6744824
SRR6744410
SRR6744224
SRR6744409
SRR6744203
SRR6745036
SRR6744572
SRR6745009
SRR6745088
SRR6744958
SRR6744989
SRR6745241
SRR6745031
SRR6744474
SRR6744336
SRR6744420
SRR6745046
SRR6745060
SRR6744693
SRR6744544
SRR6745128
SRR6744768
SRR6744239
SRR6745090
SRR6744900
SRR6745239
SRR6745235
SRR6745253
SRR6745208
SRR6745231
SRR6745071
SRR6744791
SRR6745233
SRR6745094
SRR6744332
SRR6744951
SRR6745053
SRR6744906
SRR6744589
SRR6744682
SRR6744754
SRR6744597
SRR6744064
SRR6744927
SRR6744347
SRR6744677
SRR6744912
SRR6745131
SRR6745189
SRR6745125
SRR6745102
SRR6744968
SRR6745146
SRR6745223
SRR6745099
SRR6744751
SRR6744607
SRR6744452
SRR6745029
SRR6745190
SRR6744352
SRR6745080
SRR6745220
SRR6745110
SRR6744893
SRR6744368
SRR6744647
SRR6744503
SRR6744997
SRR6745116
SRR6745079
SRR6745143
SRR6744253
SRR6743991
SRR6745187
SRR6745093
SRR6745085
SRR6744956
SRR6744812
SRR6745230
SRR6745007
SRR6743973
SRR6744127
SRR6744414
SRR6744736
SRR6745282
SRR6745133
SRR6744967
SRR6745127
SRR6744309
)


for accession in "${arr[@]}"
do
metaphlan \
    $reads_path/${accession}_1.fastq.gz,$reads_path/${accession}_2.fastq.gz \
    --input_type fastq \
    --nproc 8 \
    --index mpa_vOct22_CHOCOPhlAnSGB_202212 \
    --bowtie2db /home6/hlberman/Applications/metaphlan4/MetaPhlAn/metaphlan/metaphlan_databases/ \
    --bowtie2out $out_path/${accession}_metaphlan2_bowtie2.bz2  \
    -o $out_path/${accession}_metaphlan_bugs_list.tsv
done
