#!/bin/bash
#SBATCH -o /home6/hlberman/VMMG/metaphlan4/log/hmp2mgs_metaphlan4_5_%j.out
#SBATCH -c 8

reads_path=/home6/hlberman/VMMG/bbmap_human/hmp2mgs_filt_fastq/
out_path=/home6/hlberman/VMMG/metaphlan4/outputs/hmp2mgs_metaphlan/

# List SRA accessions
declare -a arr=(
SRR6745254
SRR6745213
SRR6745194
SRR6744078
SRR6745021
SRR6745050
SRR6744784
SRR6745149
SRR6745065
SRR6745137
SRR6744640
SRR6745171
SRR6745114
SRR6744375
SRR6745017
SRR6744070
SRR6745096
SRR6745257
SRR6745221
SRR6744534
SRR6744028
SRR6745056
SRR6744214
SRR6744637
SRR6744340
SRR6745147
SRR6744186
SRR6745183
SRR6744363
SRR6744743
SRR6744233
SRR6744495
SRR6744411
SRR6744437
SRR6744230
SRR6744821
SRR6744709
SRR6744761
SRR6744786
SRR6744247
SRR6744117
SRR6744548
SRR6744720
SRR6744881
SRR6744570
SRR6743947
SRR6744483
SRR6745041
SRR6744384
SRR6744289
SRR6745064
SRR6745184
SRR6744373
SRR6744908
SRR6745076
SRR6744456
SRR6745144
SRR6744067
SRR6745081
SRR6744865
SRR6744676
SRR6745130
SRR6745192
SRR6745062
SRR6744618
SRR6744789
SRR6744627
SRR6744845
SRR6744583
SRR6743983
SRR6745042
SRR6744054
SRR6745167
SRR6745089
SRR6744334
SRR6743959
SRR6745059
SRR6744765
SRR6745276
SRR6744612
SRR6745097
SRR6744510
SRR6744703
SRR6744249
SRR6744946
SRR6744252
SRR6744555
SRR6745043
SRR6744349
SRR6745101
SRR6744975
SRR6744988
SRR6744066
)


for accession in "${arr[@]}"
do
metaphlan \
    $reads_path/${accession}_1.fastq.gz,$reads_path/${accession}_2.fastq.gz \
    --input_type fastq \
    --nproc 8 \
    --index mpa_vOct22_CHOCOPhlAnSGB_202212 \
    --bowtie2db /home6/hlberman/Applications/metaphlan4/MetaPhlAn/metaphlan/metaphlan_databases/ \
    --bowtie2out $out_path/${accession}_metaphlan2_bowtie2.bz2  \
    -o $out_path/${accession}_metaphlan_bugs_list.tsv
done
