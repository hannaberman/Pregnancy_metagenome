#!/bin/bash
#SBATCH -o /home6/hlberman/VMMG/metaphlan4/log/hmp2mgs_metaphlan4_3_%j.out
#SBATCH -c 8

reads_path=/home6/hlberman/VMMG/bbmap_human/hmp2mgs_filt_fastq/
out_path=/home6/hlberman/VMMG/metaphlan4/outputs/hmp2mgs_metaphlan/

# List SRA accessions
declare -a arr=(
SRR6745172
SRR6745040
SRR6745112
SRR6745205
SRR6745225
SRR6745121
SRR6744870
SRR6744874
SRR6744505
SRR6744692
SRR6744489
SRR6744435
SRR6745022
SRR6744938
SRR6744022
SRR6744588
SRR6744091
SRR6743942
SRR6745132
SRR6745035
SRR6744753
SRR6745126
SRR6745278
SRR6744773
SRR6744382
SRR6744577
SRR6745039
SRR6745275
SRR6745174
SRR6744492
SRR6744031
SRR6744211
SRR6744486
SRR6744857
SRR6745072
SRR6744542
SRR6744283
SRR6744071
SRR6745024
SRR6745264
SRR6745250
SRR6744385
SRR6745011
SRR6744183
SRR6745181
SRR6744645
SRR6745077
SRR6745248
SRR6744541
SRR6744333
SRR6745166
SRR6745268
SRR6745066
SRR6744251
SRR6744954
SRR6745202
SRR6745052
SRR6745279
SRR6745218
SRR6744855
SRR6745034
SRR6745186
SRR6745216
SRR6745078
SRR6745115
SRR6744936
SRR6744012
SRR6744744
SRR6744799
SRR6744690
SRR6744502
SRR6744080
SRR6743992
SRR6744822
SRR6744661
SRR6745028
SRR6745259
SRR6745120
SRR6745025
SRR6745030
SRR6743988
SRR6744591
SRR6744296
SRR6745048
SRR6744950
SRR6745018
SRR6745155
SRR6744642
SRR6745224
SRR6745152
SRR6744394
SRR6744513
SRR6744462
)


for accession in "${arr[@]}"
do
metaphlan \
    $reads_path/${accession}_1.fastq.gz,$reads_path/${accession}_2.fastq.gz \
    --input_type fastq \
    --nproc 8 \
    --index mpa_vOct22_CHOCOPhlAnSGB_202212 \
    --bowtie2db /home6/hlberman/Applications/metaphlan4/MetaPhlAn/metaphlan/metaphlan_databases/ \
    --bowtie2out $out_path/${accession}_metaphlan2_bowtie2.bz2  \
    -o $out_path/${accession}_metaphlan_bugs_list.tsv
done
