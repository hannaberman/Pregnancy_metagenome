alns <- list.files(usearchAlns20, all.files = FALSE, full.names = TRUE)
alns
alns <- list.files(usearchAlns20, all.files = FALSE, full.names = TRUE) %>%
map(read_delim) #read in blast tables
alns <- list.files(usearchAlns20, all.files = FALSE, full.names = TRUE) %>%
map(read_delim, delim="\t", stringsAsFactors=FALSE) #read in blast tables
alns <- list.files(usearchAlns20, all.files = FALSE, full.names = TRUE) %>%
map(read_delim, delim="\t") #read in blast tables
save(alns, "/Users/hlberman/Desktop/alns.Rdata")
?save
save(alns, file="/Users/hlberman/Desktop/alns.Rdata")
View(alns[1])
?read_delim
View(alns[2])
alns <- list.files(usearchAlns20, all.files = FALSE, full.names = TRUE) %>%
map(read_delim, delim="\t", col_names=c("query", "reference", "pcntid", "length", "mismatch", "gap_open", "qstart", "qend", "rstart", "rend", "evalue", "bitscore")) #read in blast tables
library(tidyverse);packageVersion("tidyverse")
library(ShortRead);packageVersion("ShortRead")
library(rBLAST);packageVersion("rBLAST")
main_dir <- getwd()
contig_dir <- file.path(main_dir, "fastas")
fastas <- list.files(contig_dir, all.files=FALSE, full.names=FALSE)
fasta_paths <- list.files(contig_dir, all.files=FALSE, full.names=TRUE)
md_path <- file.path(main_dir, "heidelberg_metadata.csv")
md <- read_csv(md_path)
assembly_path <- "./annotated_assemblies"
new_assembly_path <- "./annotated_assemblies_byext"
roary_input_path <- "/Users/hlberman/Desktop/roary_input_gffs"
library(readxl)
wd <- getwd()
xls_path <- file.path(wd, "Heidelberg 81.xlsx")
xls <- readxl::read_excel(xls_path)
library(readxl)
wd <- getwd()
xls_path <- file.path(wd, "Heidelberg 81.xlsx")
xls <- readxl::read_excel(xls_path)
View(xls)
View(md)
xls0 <- xls %>%
rename(Strain_ID=`Strain ID`)
colnames(xls)
xls0 <- xls %>%
mutate(Strain_ID=`Strain ID`) %>%
select(-`Strain ID`)
md0 <- left_join(xls, by="StrainID")
library(readxl)
wd <- getwd()
xls_path <- file.path(wd, "Heidelberg 81.xlsx")
xls <- readxl::read_excel(xls_path)
xls0 <- xls %>%
mutate(Strain_ID=`Strain ID`) %>%
select(-`Strain ID`)
md0 <- md %>%
left_join(xls0, by="StrainID")
library(readxl)
wd <- getwd()
xls_path <- file.path(wd, "Heidelberg 81.xlsx")
xls <- readxl::read_excel(xls_path)
xls0 <- xls %>%
mutate(Strain_ID=`Strain ID`) %>%
select(-`Strain ID`)
md0 <- md %>%
left_join(xls0, by="Strain_ID")
View(md0)
colnames(md0)
md1 <- md0 %>%
mutate(FOX_res=case_when(str_detect(`Restisance profile`,"FOX")==TRUE~TRUE,
str_detect(`Resistance profile`, "FOX")==FALSE~FALSE),
TET_res=case_when(str_detect(`Restisance profile`,"TET")==TRUE~TRUE,
str_detect(`Resistance profile`, "TET")==FALSE~FALSE),
AXO_res=case_when(str_detect(`Restisance profile`,"AXO")==TRUE~TRUE,
str_detect(`Resistance profile`, "AXO")==FALSE~FALSE),
AUG2_res=case_when(str_detect(`Restisance profile`,"AUG2")==TRUE~TRUE,
str_detect(`Resistance profile`, "AUG2")==FALSE~FALSE),
CIP_res=case_when(str_detect(`Restisance profile`,"CIP")==TRUE~TRUE,
str_detect(`Resistance profile`, "CIP")==FALSE~FALSE),
XNL_res=case_when(str_detect(`Restisance profile`,"NAL")==TRUE~TRUE,
str_detect(`Resistance profile`, "NAL")==FALSE~FALSE),
XNL_res=case_when(str_detect(`Restisance profile`,"XNL")==TRUE~TRUE,
str_detect(`Resistance profile`, "XNL")==FALSE~FALSE),
AMP_res=case_when(str_detect(`Restisance profile`,"AMP")==TRUE~TRUE,
str_detect(`Resistance profile`, "AMP")==FALSE~FALSE),
CHL_res=case_when(str_detect(`Restisance profile`,"CHL")==TRUE~TRUE,
str_detect(`Resistance profile`, "CHL")==FALSE~FALSE),
SXT_res=case_when(str_detect(`Restisance profile`,"SXT")==TRUE~TRUE,
str_detect(`Resistance profile`, "SXT")==FALSE~FALSE),
STR_res=case_when(str_detect(`Restisance profile`,"STR")==TRUE~TRUE,
str_detect(`Resistance profile`, "STR")==FALSE~FALSE),
GEN_res=case_when(str_detect(`Restisance profile`,"GEN")==TRUE~TRUE,
str_detect(`Resistance profile`, "GEN")==FALSE~FALSE),
`blaCMY-2`=case_when(str_detect(`Restisance genes`,"blaCMY-2")==TRUE~TRUE,
str_detect(`Resistance genes`, "blaCMY-2")==FALSE~FALSE),
fosA7=case_when(str_detect(`Restisance genes`,"fosA7")==TRUE~TRUE,
str_detect(`Resistance genes`, "fosA7")==FALSE~FALSE),
sul2=case_when(str_detect(`Restisance genes`,"sul2")==TRUE~TRUE,
str_detect(`Resistance genes`, "sul2")==FALSE~FALSE),
`tet(A)`=case_when(str_detect(`Restisance genes`,"tet(A)")==TRUE~TRUE,
str_detect(`Resistance genes`, "tet(A)")==FALSE~FALSE),
`Inu(G)`=case_when(str_detect(`Restisance genes`,"Inu(G)")==TRUE~TRUE,
str_detect(`Resistance genes`, "Inu(G)")==FALSE~FALSE),
aadA1=case_when(str_detect(`Restisance genes`,"aadA1")==TRUE~TRUE,
str_detect(`Resistance genes`, "aadA1")==FALSE~FALSE),
aadA2=case_when(str_detect(`Restisance genes`,"aadA2")==TRUE~TRUE,
str_detect(`Resistance genes`, "aadA2")==FALSE~FALSE),
cmlA1=case_when(str_detect(`Restisance genes`,"cmlA1")==TRUE~TRUE,
str_detect(`Resistance genes`, "cmlA1")==FALSE~FALSE),
cmlA1=case_when(str_detect(`Restisance genes`,"dfrA12")==TRUE~TRUE,
str_detect(`Resistance genes`, "dfrA12")==FALSE~FALSE),
sul3=case_when(str_detect(`Restisance genes`,"sul3")==TRUE~TRUE,
str_detect(`Resistance genes`, "sul3")==FALSE~FALSE),
qacL=case_when(str_detect(`Restisance genes`,"qacL")==TRUE~TRUE,
str_detect(`Resistance genes`, "qacL")==FALSE~FALSE),
`aac(3)-Via`=case_when(str_detect(`Restisance genes`,"aac(3)-Via")==TRUE~TRUE,
str_detect(`Resistance genes`, "aac(3)-Via")==FALSE~FALSE),
`aph(3')-Ic`=case_when(str_detect(`Restisance genes`,"aph(3')-Ic")==TRUE~TRUE,
str_detect(`Resistance genes`, "aph(3')-Ic")==FALSE~FALSE),
qnrB19=case_when(str_detect(`Restisance genes`,"qnrB19")==TRUE~TRUE,
str_detect(`Resistance genes`, "qnrB19")==FALSE~FALSE),
qnrB47=case_when(str_detect(`Restisance genes`,"qnrB47")==TRUE~TRUE,
str_detect(`Resistance genes`, "qnrB47")==FALSE~FALSE)
)
md1 <- md0 %>%
mutate(FOX_res=case_when(str_detect(`Restisance profile`,"FOX")==TRUE~TRUE,
str_detect(`Resistance profile`, "FOX")==FALSE~FALSE)),
md1 <- md0 %>%
mutate(FOX_res=case_when(str_detect(`Restisance profile`,"FOX")==TRUE~TRUE,
str_detect(`Resistance profile`, "FOX")==FALSE~FALSE)) #,
md1 <- md0 %>%
mutate(FOX_res=case_when(str_detect(.$`Restisance profile`,"FOX")==TRUE~TRUE,
str_detect(.$`Resistance profile`, "FOX")==FALSE~FALSE)) #,
md1 <- md0 %>%
mutate(FOX_res=case_when(str_detect(.$`Restisance profile`,"FOX")~TRUE,
!str_detect(.$`Resistance profile`, "FOX")~FALSE)) #,
md1 <- md0 %>%
mutate(., FOX_res=case_when(str_detect(.$`Restisance profile`,"FOX")~TRUE,
!str_detect(.$`Resistance profile`, "FOX")~FALSE)) #,
md1 <- md0 %>%
mutate(., FOX_res=case_when(str_detect(`Resistance profile`,"FOX")~TRUE,
!str_detect(`Resistance profile`, "FOX")~FALSE)) #,
View(md1)
md1 <- md0 %>%
mutate(., FOX_res=case_when(str_detect(`Resistance profile`,"FOX")~TRUE,
!str_detect(`Resistance profile`, "FOX")~FALSE),
TET_res=case_when(str_detect(`Resistance profile`,"TET")~TRUE,
!str_detect(`Resistance profile`, "TET")~FALSE),
AXO_res=case_when(str_detect(`Resistance profile`,"AXO")~TRUE,
!str_detect(`Resistance profile`, "AXO")~FALSE),
AUG2_res=case_when(str_detect(`Resistance profile`,"AUG2")~TRUE,
!str_detect(`Resistance profile`, "AUG2")~FALSE),
CIP_res=case_when(str_detect(`Resistance profile`,"CIP")~TRUE,
!str_detect(`Resistance profile`, "CIP")~FALSE),
XNL_res=case_when(str_detect(`Resistance profile`,"NAL")~TRUE,
!str_detect(`Resistance profile`, "NAL")~FALSE),
XNL_res=case_when(str_detect(`Resistance profile`,"XNL")~TRUE,
!str_detect(`Resistance profile`, "XNL")~FALSE),
AMP_res=case_when(str_detect(`Resistance profile`,"AMP")~TRUE,
!str_detect(`Resistance profile`, "AMP")~FALSE),
CHL_res=case_when(str_detect(`Resistance profile`,"CHL")~TRUE,
!str_detect(`Resistance profile`, "CHL")~FALSE),
SXT_res=case_when(str_detect(`Resistance profile`,"SXT")~TRUE,
!str_detect(`Resistance profile`, "SXT")~FALSE),
STR_res=case_when(str_detect(`Resistance profile`,"STR")~TRUE,
!str_detect(`Resistance profile`, "STR")~FALSE),
GEN_res=case_when(str_detect(`Resistance profile`,"GEN")~TRUE,
!str_detect(`Resistance profile`, "GEN")~FALSE),
`blaCMY-2`=case_when(str_detect(`Resistance genes`,"blaCMY-2")~TRUE,
!str_detect(`Resistance genes`, "blaCMY-2")~FALSE),
fosA7=case_when(str_detect(`Resistance genes`,"fosA7")~TRUE,
!str_detect(`Resistance genes`, "fosA7")~FALSE),
sul2=case_when(str_detect(`Resistance genes`,"sul2")~TRUE,
!str_detect(`Resistance genes`, "sul2")~FALSE),
`tet(A)`=case_when(str_detect(`Resistance genes`,"tet(A)")~TRUE,
!str_detect(`Resistance genes`, "tet(A)")~FALSE),
`Inu(G)`=case_when(str_detect(`Resistance genes`,"Inu(G)")~TRUE,
!str_detect(`Resistance genes`, "Inu(G)")~FALSE),
aadA1=case_when(str_detect(`Resistance genes`,"aadA1")~TRUE,
!str_detect(`Resistance genes`, "aadA1")~FALSE),
aadA2=case_when(str_detect(`Resistance genes`,"aadA2")~TRUE,
!str_detect(`Resistance genes`, "aadA2")~FALSE),
cmlA1=case_when(str_detect(`Resistance genes`,"cmlA1")~TRUE,
!str_detect(`Resistance genes`, "cmlA1")~FALSE),
cmlA1=case_when(str_detect(`Resistance genes`,"dfrA12")~TRUE,
!str_detect(`Resistance genes`, "dfrA12")~FALSE),
sul3=case_when(str_detect(`Resistance genes`,"sul3")~TRUE,
!str_detect(`Resistance genes`, "sul3")~FALSE),
qacL=case_when(str_detect(`Resistance genes`,"qacL")~TRUE,
!str_detect(`Resistance genes`, "qacL")~FALSE),
`aac(3)-Via`=case_when(str_detect(`Resistance genes`,"aac(3)-Via")~TRUE,
!str_detect(`Resistance genes`, "aac(3)-Via")~FALSE),
`aph(3')-Ic`=case_when(str_detect(`Resistance genes`,"aph(3')-Ic")~TRUE,
!str_detect(`Resistance genes`, "aph(3')-Ic")~FALSE),
qnrB19=case_when(str_detect(`Resistance genes`,"qnrB19")~TRUE,
!str_detect(`Resistance genes`, "qnrB19")~FALSE),
qnrB47=case_when(str_detect(`Resistance genes`,"qnrB47")~TRUE,
!str_detect(`Resistance genes`, "qnrB47")~FALSE)
)
library(readxl)
wd <- getwd()
xls_path <- file.path(wd, "Heidelberg 81.xlsx")
xls <- readxl::read_excel(xls_path)
xls0 <- xls %>%
mutate(Strain_ID=`Strain ID`) %>%
select(-`Strain ID`)
md0 <- md %>%
left_join(xls0, by="Strain_ID")
md1 <- md0 %>%
mutate(., FOX_res=case_when(str_detect(`Resistance profile`,"FOX")~TRUE,
!str_detect(`Resistance profile`, "FOX")~FALSE),
TET_res=case_when(str_detect(`Resistance profile`,"TET")~TRUE,
!str_detect(`Resistance profile`, "TET")~FALSE),
AXO_res=case_when(str_detect(`Resistance profile`,"AXO")~TRUE,
!str_detect(`Resistance profile`, "AXO")~FALSE),
AUG2_res=case_when(str_detect(`Resistance profile`,"AUG2")~TRUE,
!str_detect(`Resistance profile`, "AUG2")~FALSE),
CIP_res=case_when(str_detect(`Resistance profile`,"CIP")~TRUE,
!str_detect(`Resistance profile`, "CIP")~FALSE),
XNL_res=case_when(str_detect(`Resistance profile`,"NAL")~TRUE,
!str_detect(`Resistance profile`, "NAL")~FALSE),
XNL_res=case_when(str_detect(`Resistance profile`,"XNL")~TRUE,
!str_detect(`Resistance profile`, "XNL")~FALSE),
AMP_res=case_when(str_detect(`Resistance profile`,"AMP")~TRUE,
!str_detect(`Resistance profile`, "AMP")~FALSE),
CHL_res=case_when(str_detect(`Resistance profile`,"CHL")~TRUE,
!str_detect(`Resistance profile`, "CHL")~FALSE),
SXT_res=case_when(str_detect(`Resistance profile`,"SXT")~TRUE,
!str_detect(`Resistance profile`, "SXT")~FALSE),
STR_res=case_when(str_detect(`Resistance profile`,"STR")~TRUE,
!str_detect(`Resistance profile`, "STR")~FALSE),
GEN_res=case_when(str_detect(`Resistance profile`,"GEN")~TRUE,
!str_detect(`Resistance profile`, "GEN")~FALSE),
`blaCMY-2`=case_when(str_detect(`Resistance genes`,"blaCMY-2")~TRUE,
!str_detect(`Resistance genes`, "blaCMY-2")~FALSE),
fosA7=case_when(str_detect(`Resistance genes`,"fosA7")~TRUE,
!str_detect(`Resistance genes`, "fosA7")~FALSE),
sul2=case_when(str_detect(`Resistance genes`,"sul2")~TRUE,
!str_detect(`Resistance genes`, "sul2")~FALSE),
`tet(A)`=case_when(str_detect(`Resistance genes`,"tet(A)")~TRUE,
!str_detect(`Resistance genes`, "tet(A)")~FALSE),
`Inu(G)`=case_when(str_detect(`Resistance genes`,"Inu(G)")~TRUE,
!str_detect(`Resistance genes`, "Inu(G)")~FALSE),
aadA1=case_when(str_detect(`Resistance genes`,"aadA1")~TRUE,
!str_detect(`Resistance genes`, "aadA1")~FALSE),
aadA2=case_when(str_detect(`Resistance genes`,"aadA2")~TRUE,
!str_detect(`Resistance genes`, "aadA2")~FALSE),
cmlA1=case_when(str_detect(`Resistance genes`,"cmlA1")~TRUE,
!str_detect(`Resistance genes`, "cmlA1")~FALSE),
cmlA1=case_when(str_detect(`Resistance genes`,"dfrA12")~TRUE,
!str_detect(`Resistance genes`, "dfrA12")~FALSE),
sul3=case_when(str_detect(`Resistance genes`,"sul3")~TRUE,
!str_detect(`Resistance genes`, "sul3")~FALSE),
qacL=case_when(str_detect(`Resistance genes`,"qacL")~TRUE,
!str_detect(`Resistance genes`, "qacL")~FALSE),
`aac(3)-Via`=case_when(str_detect(`Resistance genes`,"aac(3)-Via")~TRUE,
!str_detect(`Resistance genes`, "aac(3)-Via")~FALSE),
`aph(3')-Ic`=case_when(str_detect(`Resistance genes`,"aph(3')-Ic")~TRUE,
!str_detect(`Resistance genes`, "aph(3')-Ic")~FALSE),
qnrB19=case_when(str_detect(`Resistance genes`,"qnrB19")~TRUE,
!str_detect(`Resistance genes`, "qnrB19")~FALSE),
qnrB47=case_when(str_detect(`Resistance genes`,"qnrB47")~TRUE,
!str_detect(`Resistance genes`, "qnrB47")~FALSE)
)
library(readxl)
wd <- getwd()
xls_path <- file.path(wd, "Heidelberg 81.xlsx")
xls <- readxl::read_excel(xls_path)
xls0 <- xls %>%
mutate(Strain_ID=`Strain ID`) %>%
select(-`Strain ID`)
md0 <- md %>%
left_join(xls0, by="Strain_ID")
md1 <- md0 %>%
mutate(., FOX_res=case_when(str_detect(`Resistance profile`,"FOX")~TRUE,
!str_detect(`Resistance profile`, "FOX")~FALSE),
TET=case_when(str_detect(`Resistance profile`,"TET")~TRUE,
!str_detect(`Resistance profile`, "TET")~FALSE),
AXO=case_when(str_detect(`Resistance profile`,"AXO")~TRUE,
!str_detect(`Resistance profile`, "AXO")~FALSE),
AUG2=case_when(str_detect(`Resistance profile`,"AUG2")~TRUE,
!str_detect(`Resistance profile`, "AUG2")~FALSE),
CIP=case_when(str_detect(`Resistance profile`,"CIP")~TRUE,
!str_detect(`Resistance profile`, "CIP")~FALSE),
XNL=case_when(str_detect(`Resistance profile`,"NAL")~TRUE,
!str_detect(`Resistance profile`, "NAL")~FALSE),
XNL=case_when(str_detect(`Resistance profile`,"XNL")~TRUE,
!str_detect(`Resistance profile`, "XNL")~FALSE),
AMP=case_when(str_detect(`Resistance profile`,"AMP")~TRUE,
!str_detect(`Resistance profile`, "AMP")~FALSE),
CHL=case_when(str_detect(`Resistance profile`,"CHL")~TRUE,
!str_detect(`Resistance profile`, "CHL")~FALSE),
SXT=case_when(str_detect(`Resistance profile`,"SXT")~TRUE,
!str_detect(`Resistance profile`, "SXT")~FALSE),
STR=case_when(str_detect(`Resistance profile`,"STR")~TRUE,
!str_detect(`Resistance profile`, "STR")~FALSE),
GEN=case_when(str_detect(`Resistance profile`,"GEN")~TRUE,
!str_detect(`Resistance profile`, "GEN")~FALSE),
`blaCMY-2`=case_when(str_detect(`Resistance genes`,"blaCMY-2")~TRUE,
!str_detect(`Resistance genes`, "blaCMY-2")~FALSE),
fosA7=case_when(str_detect(`Resistance genes`,"fosA7")~TRUE,
!str_detect(`Resistance genes`, "fosA7")~FALSE),
sul2=case_when(str_detect(`Resistance genes`,"sul2")~TRUE,
!str_detect(`Resistance genes`, "sul2")~FALSE),
`tet(A)`=case_when(str_detect(`Resistance genes`,"tet(A)")~TRUE,
!str_detect(`Resistance genes`, "tet(A)")~FALSE),
`Inu(G)`=case_when(str_detect(`Resistance genes`,"Inu(G)")~TRUE,
!str_detect(`Resistance genes`, "Inu(G)")~FALSE),
aadA1=case_when(str_detect(`Resistance genes`,"aadA1")~TRUE,
!str_detect(`Resistance genes`, "aadA1")~FALSE),
aadA2=case_when(str_detect(`Resistance genes`,"aadA2")~TRUE,
!str_detect(`Resistance genes`, "aadA2")~FALSE),
cmlA1=case_when(str_detect(`Resistance genes`,"cmlA1")~TRUE,
!str_detect(`Resistance genes`, "cmlA1")~FALSE),
cmlA1=case_when(str_detect(`Resistance genes`,"dfrA12")~TRUE,
!str_detect(`Resistance genes`, "dfrA12")~FALSE),
sul3=case_when(str_detect(`Resistance genes`,"sul3")~TRUE,
!str_detect(`Resistance genes`, "sul3")~FALSE),
qacL=case_when(str_detect(`Resistance genes`,"qacL")~TRUE,
!str_detect(`Resistance genes`, "qacL")~FALSE),
`aac(3)-Via`=case_when(str_detect(`Resistance genes`,"aac(3)-Via")~TRUE,
!str_detect(`Resistance genes`, "aac(3)-Via")~FALSE),
`aph(3')-Ic`=case_when(str_detect(`Resistance genes`,"aph(3')-Ic")~TRUE,
!str_detect(`Resistance genes`, "aph(3')-Ic")~FALSE),
qnrB19=case_when(str_detect(`Resistance genes`,"qnrB19")~TRUE,
!str_detect(`Resistance genes`, "qnrB19")~FALSE),
qnrB47=case_when(str_detect(`Resistance genes`,"qnrB47")~TRUE,
!str_detect(`Resistance genes`, "qnrB47")~FALSE)
)
library(readxl)
wd <- getwd()
xls_path <- file.path(wd, "Heidelberg 81.xlsx")
xls <- readxl::read_excel(xls_path)
xls0 <- xls %>%
mutate(Strain_ID=`Strain ID`) %>%
select(-`Strain ID`)
md0 <- md %>%
left_join(xls0, by="Strain_ID")
md1 <- md0 %>%
mutate(., FOX=case_when(str_detect(`Resistance profile`,"FOX")~TRUE,
!str_detect(`Resistance profile`, "FOX")~FALSE),
TET=case_when(str_detect(`Resistance profile`,"TET")~TRUE,
!str_detect(`Resistance profile`, "TET")~FALSE),
AXO=case_when(str_detect(`Resistance profile`,"AXO")~TRUE,
!str_detect(`Resistance profile`, "AXO")~FALSE),
AUG2=case_when(str_detect(`Resistance profile`,"AUG2")~TRUE,
!str_detect(`Resistance profile`, "AUG2")~FALSE),
CIP=case_when(str_detect(`Resistance profile`,"CIP")~TRUE,
!str_detect(`Resistance profile`, "CIP")~FALSE),
XNL=case_when(str_detect(`Resistance profile`,"NAL")~TRUE,
!str_detect(`Resistance profile`, "NAL")~FALSE),
XNL=case_when(str_detect(`Resistance profile`,"XNL")~TRUE,
!str_detect(`Resistance profile`, "XNL")~FALSE),
AMP=case_when(str_detect(`Resistance profile`,"AMP")~TRUE,
!str_detect(`Resistance profile`, "AMP")~FALSE),
CHL=case_when(str_detect(`Resistance profile`,"CHL")~TRUE,
!str_detect(`Resistance profile`, "CHL")~FALSE),
SXT=case_when(str_detect(`Resistance profile`,"SXT")~TRUE,
!str_detect(`Resistance profile`, "SXT")~FALSE),
STR=case_when(str_detect(`Resistance profile`,"STR")~TRUE,
!str_detect(`Resistance profile`, "STR")~FALSE),
GEN=case_when(str_detect(`Resistance profile`,"GEN")~TRUE,
!str_detect(`Resistance profile`, "GEN")~FALSE),
`blaCMY-2`=case_when(str_detect(`Resistance genes`,"blaCMY-2")~TRUE,
!str_detect(`Resistance genes`, "blaCMY-2")~FALSE),
fosA7=case_when(str_detect(`Resistance genes`,"fosA7")~TRUE,
!str_detect(`Resistance genes`, "fosA7")~FALSE),
sul2=case_when(str_detect(`Resistance genes`,"sul2")~TRUE,
!str_detect(`Resistance genes`, "sul2")~FALSE),
`tet(A)`=case_when(str_detect(`Resistance genes`,"tet(A)")~TRUE,
!str_detect(`Resistance genes`, "tet(A)")~FALSE),
`Inu(G)`=case_when(str_detect(`Resistance genes`,"Inu(G)")~TRUE,
!str_detect(`Resistance genes`, "Inu(G)")~FALSE),
aadA1=case_when(str_detect(`Resistance genes`,"aadA1")~TRUE,
!str_detect(`Resistance genes`, "aadA1")~FALSE),
aadA2=case_when(str_detect(`Resistance genes`,"aadA2")~TRUE,
!str_detect(`Resistance genes`, "aadA2")~FALSE),
cmlA1=case_when(str_detect(`Resistance genes`,"cmlA1")~TRUE,
!str_detect(`Resistance genes`, "cmlA1")~FALSE),
cmlA1=case_when(str_detect(`Resistance genes`,"dfrA12")~TRUE,
!str_detect(`Resistance genes`, "dfrA12")~FALSE),
sul3=case_when(str_detect(`Resistance genes`,"sul3")~TRUE,
!str_detect(`Resistance genes`, "sul3")~FALSE),
qacL=case_when(str_detect(`Resistance genes`,"qacL")~TRUE,
!str_detect(`Resistance genes`, "qacL")~FALSE),
`aac(3)-Via`=case_when(str_detect(`Resistance genes`,"aac(3)-Via")~TRUE,
!str_detect(`Resistance genes`, "aac(3)-Via")~FALSE),
`aph(3')-Ic`=case_when(str_detect(`Resistance genes`,"aph(3')-Ic")~TRUE,
!str_detect(`Resistance genes`, "aph(3')-Ic")~FALSE),
qnrB19=case_when(str_detect(`Resistance genes`,"qnrB19")~TRUE,
!str_detect(`Resistance genes`, "qnrB19")~FALSE),
qnrB47=case_when(str_detect(`Resistance genes`,"qnrB47")~TRUE,
!str_detect(`Resistance genes`, "qnrB47")~FALSE)
)
library(readxl)
wd <- getwd()
xls_path <- file.path(wd, "Heidelberg 81.xlsx")
xls <- readxl::read_excel(xls_path)
xls0 <- xls %>%
mutate(Strain_ID=`Strain ID`) %>%
select(-`Strain ID`)
md0 <- md %>%
left_join(xls0, by="Strain_ID")
md1 <- md0 %>%
mutate(., FOX=case_when(str_detect(`Resistance profile`,"FOX")~TRUE,
!str_detect(`Resistance profile`, "FOX")~FALSE),
TET=case_when(str_detect(`Resistance profile`,"TET")~TRUE,
!str_detect(`Resistance profile`, "TET")~FALSE),
AXO=case_when(str_detect(`Resistance profile`,"AXO")~TRUE,
!str_detect(`Resistance profile`, "AXO")~FALSE),
AUG2=case_when(str_detect(`Resistance profile`,"AUG2")~TRUE,
!str_detect(`Resistance profile`, "AUG2")~FALSE),
CIP=case_when(str_detect(`Resistance profile`,"CIP")~TRUE,
!str_detect(`Resistance profile`, "CIP")~FALSE),
XNL=case_when(str_detect(`Resistance profile`,"NAL")~TRUE,
!str_detect(`Resistance profile`, "NAL")~FALSE),
XNL=case_when(str_detect(`Resistance profile`,"XNL")~TRUE,
!str_detect(`Resistance profile`, "XNL")~FALSE),
AMP=case_when(str_detect(`Resistance profile`,"AMP")~TRUE,
!str_detect(`Resistance profile`, "AMP")~FALSE),
CHL=case_when(str_detect(`Resistance profile`,"CHL")~TRUE,
!str_detect(`Resistance profile`, "CHL")~FALSE),
SXT=case_when(str_detect(`Resistance profile`,"SXT")~TRUE,
!str_detect(`Resistance profile`, "SXT")~FALSE),
STR=case_when(str_detect(`Resistance profile`,"STR")~TRUE,
!str_detect(`Resistance profile`, "STR")~FALSE),
GEN=case_when(str_detect(`Resistance profile`,"GEN")~TRUE,
!str_detect(`Resistance profile`, "GEN")~FALSE),
`blaCMY-2`=case_when(str_detect(`Resistance genes`,"blaCMY-2")~TRUE,
!str_detect(`Resistance genes`, "blaCMY-2")~FALSE),
fosA7=case_when(str_detect(`Resistance genes`,"fosA7")~TRUE,
!str_detect(`Resistance genes`, "fosA7")~FALSE),
sul2=case_when(str_detect(`Resistance genes`,"sul2")~TRUE,
!str_detect(`Resistance genes`, "sul2")~FALSE),
`tet(A)`=case_when(str_detect(`Resistance genes`,"tet(A)")~TRUE,
!str_detect(`Resistance genes`, "tet(A)")~FALSE),
`Inu(G)`=case_when(str_detect(`Resistance genes`,"Inu(G)")~TRUE,
!str_detect(`Resistance genes`, "Inu(G)")~FALSE),
aadA1=case_when(str_detect(`Resistance genes`,"aadA1")~TRUE,
!str_detect(`Resistance genes`, "aadA1")~FALSE),
aadA2=case_when(str_detect(`Resistance genes`,"aadA2")~TRUE,
!str_detect(`Resistance genes`, "aadA2")~FALSE),
cmlA1=case_when(str_detect(`Resistance genes`,"cmlA1")~TRUE,
!str_detect(`Resistance genes`, "cmlA1")~FALSE),
cmlA1=case_when(str_detect(`Resistance genes`,"dfrA12")~TRUE,
!str_detect(`Resistance genes`, "dfrA12")~FALSE),
sul3=case_when(str_detect(`Resistance genes`,"sul3")~TRUE,
!str_detect(`Resistance genes`, "sul3")~FALSE),
qacL=case_when(str_detect(`Resistance genes`,"qacL")~TRUE,
!str_detect(`Resistance genes`, "qacL")~FALSE),
`aac(3)-Via`=case_when(str_detect(`Resistance genes`,"aac(3)-Via")~TRUE,
!str_detect(`Resistance genes`, "aac(3)-Via")~FALSE),
`aph(3')-Ic`=case_when(str_detect(`Resistance genes`,"aph(3')-Ic")~TRUE,
!str_detect(`Resistance genes`, "aph(3')-Ic")~FALSE),
qnrB19=case_when(str_detect(`Resistance genes`,"qnrB19")~TRUE,
!str_detect(`Resistance genes`, "qnrB19")~FALSE),
qnrB47=case_when(str_detect(`Resistance genes`,"qnrB47")~TRUE,
!str_detect(`Resistance genes`, "qnrB47")~FALSE)
)
write_csv(md1, "./heidelberg_metadata.csv")
library(RColorBrewer); packageVersion("RColorBrewer")
library(ggplot2); packageVersion("ggplot2")
library(readr); packageVersion("readr")
library(tidyverse)
md <- read_csv("./heidelberg_metadata.csv")
View(md)
md <- md %>%
mutate(Strain_ID=case_when(Strain_ID=="ST012"~"Sty012",
Strain_ID!="ST012"~Strain_ID))
colnames(md)
hist(md$Gene_count[md$Include == TRUE],
xlab = "Gene Count",
ylab = "Frequency",
main = " ",
col = "#3D79F3CC",
ylim = c(0, 20),
cex.axis = 1.5,
cex.lab = 1.5
)
hist(md$Gene_count,
xlab = "Gene Count",
ylab = "Frequency",
main = " ",
col = "#3D79F3CC",
ylim = c(0, 20),
cex.axis = 1.5,
cex.lab = 1.5
)
summaryStats <- read_delim("./qnr_roary95/summary_statistics.txt", delim = "\t", col_names = FALSE)
summaryStats <- read_delim(file.path(roary_dir, "summary_statistics.txt"), delim = "\t", col_names = FALSE)
roary_dir <- "./roary_95"
summaryStats <- read_delim(file.path(roary_dir, "summary_statistics.txt"), delim = "\t", col_names = FALSE)
colnames(summaryStats) <- c("Category", "Frequency", "Count")
pieStats <- as.data.frame(cbind(`Gene category` = c("Core genes (99 to 100% of strains)", "Soft core genes (95 to 99% of strains)", "Shell genes (15 to 95% of strains)", "Cloud genes (0 to 15% of strains)"),
Count =  summaryStats$Count[1:4]))
pieStats$Count <- as.numeric(as.character(pieStats$Count))
pieStats
pieStats0 <- pieStats %>%
mutate(`Gene category` = factor(`Gene category`, pieStats$`Gene category`))
bp <- ggplot(data = pieStats0, aes(x="", y=Count, fill= `Gene category`)) +
geom_bar(width = 1,
stat = "identity") +
theme_minimal()
bp
pie <- bp + coord_polar(theta = "y", start=0, direction = -1, clip = "off") +
xlab(" ") +
ylab(" ") +
#scale_fill_manual(values = c("#D57A6DFF", "#E8B762FF", "#9CCDDFFF", "#525052FF")) +
#scale_fill_manual(values = c("#5FB233FF", "#6A7F93FF", "#EB0F13FF", "#8F2F8BFF")) +
scale_fill_manual(values = c("#3D79F3CC", "#E6352FCC", "#F9B90ACC", "#34A74BCC")) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid  = element_blank())
# text = element_text(size=30))
pie
