filter(n_distinct(Clade)>1) %>%
ungroup()
ambiguous99top_99 <-table(diffClades99top_99$Annotation, diffClades99top_99$Clade)
print("ambiguous annotations with ~99% id")
ambiguous99top_99
#write.csv(as.data.frame(unclass(ambiguous99top_99)), file.path(gdrive_path, "ambiguousHits99top_99.csv"))
alns099_top <- alns99top %>%
map(~select(.x, query, pcntid, SampleID, SubjectID, GWcoll, RNAlater, PaperCohort, Annotation, Clade)) %>%
map(~unique.data.frame(.x)) %>%
purrr::reduce(full_join, by= c("query", "pcntid", "SampleID", "SubjectID", "GWcoll", "RNAlater", "PaperCohort", "Annotation", "Clade"))
ggplot(data=alns099_top) +
geom_bar(aes(x=Annotation, color=as.character(Clade), fill=as.character(Clade))) +
facet_wrap(~SampleID) +
theme_classic() +
theme(axis.text.x = element_text(angle=90, size=2)) +
labs(title = "Hits by Annotation (top hit above 99% ID)", color="Clade", fill="Clade")
#ggsave(file.path(gdrive_path, "figures", "annotationBarPlot99top.pdf"), width=30, height=20)
#let's zoom in on a few samples
#4009035268
`4009035268` <- alns099_top %>%
filter(SampleID=="4009035268")
ggplot(data=`4009035268`) +
geom_bar(aes(x=Annotation, color=as.character(Clade), fill=as.character(Clade))) +
theme_classic() +
theme(axis.text.x = element_text(angle=45, hjust=1, size = 6)) +
labs(title = "Hits by Annotation Sample 4009035268 (top hid >=99% ID)", color="Clade", fill="Clade")
#ggsave(file.path(gdrive_path, "figures", "4009035268annotationBarPlot99top.pdf"))
#1061635208
`1061635208` <- alns099_top %>%
filter(SampleID=="1061635208")
ggplot(data=`1061635208`) +
geom_bar(aes(x=Annotation, color=as.character(Clade), fill=as.character(Clade))) +
theme_classic() +
theme(axis.text.x = element_text(angle=45, hjust=1, size = 6)) +
labs(title = "Hits by Annotation Sample 1061635208 (top hid >=99% ID)", color="Clade", fill="Clade")
#ggsave(file.path(gdrive_path, "figures", "1061635208annotationBarPlot99top.pdf"))
#4002101198
`4002101198` <- alns099_top %>%
filter(SampleID=="4002101198")
ggplot(data=`4002101198`) +
geom_bar(aes(x=Annotation, color=as.character(Clade), fill=as.character(Clade))) +
theme_classic() +
theme(axis.text.x = element_text(angle=45, hjust=1, size = 6)) +
labs(title = "Hits by Annotation Sample 4002101198 (top hid >=99% ID)", color="Clade", fill="Clade")
#ggsave(file.path(gdrive_path, "figures", "4002101198annotationBarPlot99top.pdf"))
#4002101298
`4002101298` <- alns099_top %>%
filter(SampleID=="4002101298")
ggplot(data=`4002101298`) +
geom_bar(aes(x=Annotation, color=as.character(Clade), fill=as.character(Clade))) +
theme_classic() +
theme(axis.text.x = element_text(angle=45, hjust=1, size = 6)) +
labs(title = "Hits by Annotation Sample 4002101298 (top hid >=99% ID)", color="Clade", fill="Clade")
#ggsave(file.path(gdrive_path, "figures", "4002101298annotationBarPlot99top.pdf"))
#4007535358
`4007535358` <- alns099_top %>%
filter(SampleID=="4007535358")
ggplot(data=`4007535358`) +
geom_bar(aes(x=Annotation, color=as.character(Clade), fill=as.character(Clade))) +
theme_classic() +
theme(axis.text.x = element_text(angle=45, hjust=1, size = 6)) +
labs(title = "Hits by Annotation Sample 4007535358 (top hid >=99% ID)", color="Clade", fill="Clade")
#ggsave(file.path(gdrive_path, "figures", "4007535358annotationBarPlot99top.pdf"))
compare16S99top <- alns099_top %>%
filter(PaperCohort == 2017,
Annotation !="30S ribosomal protein S15",
Annotation !="30S ribosomal protein S2",
Annotation !="50S ribosomal protein L31",
Annotation !="Glutamyl-tRNA(Gln) amidotransferase subunit C",
Annotation !="Phosphoglucomutase",
Annotation !="Transketolase",
Annotation !="Pyruvate formate-lyase 1-activating enzyme" ,
Annotation !="Ribonucleoside-diphosphate reductase subunit beta nrdF2",
Annotation !="Valine--tRNA ligase") %>%
group_by(SampleID) %>%
count(Clade) %>%
mutate(propClade=(n/sum(n)),
Clade=as.character(Clade)) %>%
left_join(sgDF[,c("SampleID","SubjectID", "GWcoll", "RNAlater")], by="SampleID") %>%
full_join(sgDF["PaperCohort"==2017, "SampleID"], by="SampleID") %>%
full_join(subjects16S, by="SubjectID")
compare16S99top <- alns099_top %>%
filter(PaperCohort == 2017,
Annotation !="30S ribosomal protein S15",
Annotation !="30S ribosomal protein S2",
Annotation !="50S ribosomal protein L31",
Annotation !="Glutamyl-tRNA(Gln) amidotransferase subunit C",
Annotation !="Phosphoglucomutase",
Annotation !="Transketolase",
Annotation !="Pyruvate formate-lyase 1-activating enzyme" ,
Annotation !="Ribonucleoside-diphosphate reductase subunit beta nrdF2",
Annotation !="Valine--tRNA ligase") %>%
group_by(SampleID) %>%
count(Clade) %>%
mutate(propClade=(n/sum(n)),
Clade=as.character(Clade)) %>%
left_join(sgDF[,c("SampleID","SubjectID", "GWcoll", "RNAlater")], by="SampleID") %>%
full_join(sgDF["PaperCohort"==2017, "SampleID"], by="SampleID") %>%
full_join(subjects16S, by="SubjectID")
subjects16S <- data.frame(SubjectID=c("40072", "10621", "40069", "10616", "19024", "40084", "10627", "10056", "10629", "40021", "40047", "40090", "40059", "40075", "40074", "40098", "10626", "40066", "40071", "20505", "40049", "40032", "40042", "10612", "10508", "10608", "10623"))
compare16S99top <- alns099_top %>%
filter(PaperCohort == 2017,
Annotation !="30S ribosomal protein S15",
Annotation !="30S ribosomal protein S2",
Annotation !="50S ribosomal protein L31",
Annotation !="Glutamyl-tRNA(Gln) amidotransferase subunit C",
Annotation !="Phosphoglucomutase",
Annotation !="Transketolase",
Annotation !="Pyruvate formate-lyase 1-activating enzyme" ,
Annotation !="Ribonucleoside-diphosphate reductase subunit beta nrdF2",
Annotation !="Valine--tRNA ligase") %>%
group_by(SampleID) %>%
count(Clade) %>%
mutate(propClade=(n/sum(n)),
Clade=as.character(Clade)) %>%
left_join(sgDF[,c("SampleID","SubjectID", "GWcoll", "RNAlater")], by="SampleID") %>%
full_join(sgDF["PaperCohort"==2017, "SampleID"], by="SampleID") %>%
full_join(subjects16S, by="SubjectID")
ggplot(data=compare16S99top, aes(x=GWcoll, y=propClade, color=Clade, shape=RNAlater)) +
geom_point() +
facet_wrap(~SubjectID) +
scale_color_manual(values=c("indianred1", "indianred3", "steelblue1", "steelblue3", "darkorchid2", "yellowgreen" )) +
labs(title = "Clade assignments by shotgun sequencing:\nFiltering top hits >=99%ID", x= "Gestation weeks at collection", y="Proportion of Gardnerella", shape="RNA Later", color="Clade")
#ggsave(filename = file.path(gdrive_path, "cladesByShotgun99top_filtered.pdf"))
ggplot(data=compare16S99top, aes(x=GWcoll, y=propClade, color=Clade, fill=Clade)) +
geom_bar(stat = "identity") +
facet_wrap(~SubjectID) +
scale_color_manual(values=c("indianred1", "indianred3", "steelblue1", "steelblue3", "darkorchid2", "yellowgreen" )) +
scale_fill_manual(values=c("indianred1", "indianred3", "steelblue1", "steelblue3", "darkorchid2", "yellowgreen" )) +
labs(title = "Clade assignments by shotgun sequencing:\nFiltering top hits >=99%ID", x= "Gestation weeks at collection", y="Proportion of Gardnerella", shape="RNA Later", fill="Clade")
#ggsave(filename = file.path(gdrive_path, "cladesByShotgun99top_filtered_bar.pdf"))
ggplot(data = ReadsPerSample, aes(readspersample)) +
geom_histogram() +
theme_classic() +
scale_x_continuous(breaks = seq(0, 2000, by = 10)) +
scale_y_continuous(breaks = seq(0, 50, by = 5)) +
labs(title = "Reads per sample", x = "# Reads")
ggplot(data = ReadsPerSample, aes(readspersample)) +
geom_histogram() +
theme_classic() +
xlim(0,200) +
scale_x_continuous(breaks = seq(0, 2000, by = 10)) +
scale_y_continuous(breaks = seq(0, 50, by = 5)) +
labs(title = "Reads per sample", x = "# Reads")
ggplot(data = ReadsPerSample, aes(readspersample)) +
geom_histogram() +
theme_classic() +
xlim(0,2000) +
scale_y_continuous(breaks = seq(0, 50, by = 5)) +
labs(title = "Reads per sample", x = "# Reads")
ggplot(data = ReadsPerSample, aes(readspersample)) +
geom_histogram(binwidth = 10) +
theme_classic() +
xlim(0,2000) +
scale_y_continuous(breaks = seq(0, 50, by = 5)) +
labs(title = "Reads per sample", x = "# Reads")
ggplot(data = ReadsPerSample, aes(readspersample)) +
geom_histogram(binwidth = 20) +
theme_classic() +
xlim(0,2000) +
scale_y_continuous(breaks = seq(0, 50, by = 5)) +
labs(title = "Reads per sample", x = "# Reads")
View(ReadsPerSample)
ggplot(data = ReadsPerSample, aes(readspersample)) +
geom_histogram(binwidth = 10) +
theme_classic() +
xlim(0,500) +
scale_y_continuous(breaks = seq(0, 50, by = 5)) +
labs(title = "Reads per sample", x = "# Reads")
ggplot(data = ReadsPerSample, aes(readspersample)) +
geom_histogram(binwidth = 5) +
theme_classic() +
xlim(0,100) +
scale_y_continuous(breaks = seq(0, 50, by = 5)) +
labs(title = "Reads per sample", x = "# Reads")
ggplot(data = ReadsPerSample, aes(readspersample)) +
geom_histogram(binwidth = 2) +
theme_classic() +
xlim(0,50) +
scale_y_continuous(breaks = seq(0, 50, by = 5)) +
labs(title = "Reads per sample", x = "# Reads")
ggplot(data = ReadsPerSample, aes(readspersample)) +
geom_histogram(binwidth = 10) +
theme_classic() +
xlim(0,400) +
scale_y_continuous(breaks = seq(0, 50, by = 5)) +
labs(title = "Reads per sample", x = "# Reads")
ggplot(data = CladesPerSample, aes(nClades)) +
geom_histogram() +
theme_classic() +
scale_x_continuous(breaks = seq(0, 400, by = 10))
ggplot(data = ReadsPerSample, aes(readspersample)) +
geom_histogram(binwidth = 10) +
theme_classic() +
xlim(0,400) +
scale_y_continuous(breaks = seq(0, 400, by = 10)) +
scale_y_continuous(breaks = seq(0, 50, by = 5)) +
labs(title = "Reads per sample", x = "# Reads")
ggplot(data = ReadsPerSample, aes(readspersample)) +
geom_histogram(binwidth = 10) +
theme_classic() +
xlim(0,400) +
scale_x_continuous(breaks = seq(0, 400, by = 10)) +
scale_y_continuous(breaks = seq(0, 50, by = 5)) +
labs(title = "Reads per sample", x = "# Reads")
?xlim()
ggplot(data = ReadsPerSample, aes(readspersample)) +
geom_histogram(binwidth = 10) +
theme_classic() +
scale_x_continuous(breaks = seq(0, 400, by = 10)) +
xlim(0,400) +
scale_y_continuous(breaks = seq(0, 50, by = 5)) +
labs(title = "Reads per sample", x = "# Reads")
View(refAnnotations)
View(refDF)
View(alns099_top)
gardRelativeAbundance <-  alignmentsFinal %>%
group_by(SampleID) %>%
count(Clade) %>%
mutate(propClade=(n/sum(n)),
Clade=as.character(Clade))
alignmentsFinal <- alns099_top %>%
filter(Annotation !="30S ribosomal protein S15",
Annotation !="30S ribosomal protein S2",
Annotation !="50S ribosomal protein L31",
Annotation !="Glutamyl-tRNA(Gln) amidotransferase subunit C",
Annotation !="Phosphoglucomutase",
Annotation !="Transketolase",
Annotation !="Pyruvate formate-lyase 1-activating enzyme" ,
Annotation !="Ribonucleoside-diphosphate reductase subunit beta nrdF2",
Annotation !="Valine--tRNA ligase")
View(alignmentsFinal)
alignmentsFinal <- alns099_top %>%
filter(Annotation !="30S ribosomal protein S15",
Annotation !="30S ribosomal protein S2",
Annotation !="50S ribosomal protein L31",
Annotation !="Glutamyl-tRNA(Gln) amidotransferase subunit C",
Annotation !="Phosphoglucomutase",
Annotation !="Transketolase",
Annotation !="Pyruvate formate-lyase 1-activating enzyme" ,
Annotation !="Ribonucleoside-diphosphate reductase subunit beta nrdF2",
Annotation !="Valine--tRNA ligase")
gardRelativeAbundance <-  alignmentsFinal %>%
group_by(SampleID) %>%
count(Clade) %>%
mutate(propClade=(n/sum(n)),
Clade=as.character(Clade))
View(gardRelativeAbundance)
alignmentsFinal <- alns099_top %>%
filter(Annotation !="30S ribosomal protein S15",
Annotation !="30S ribosomal protein S2",
Annotation !="50S ribosomal protein L31",
Annotation !="Glutamyl-tRNA(Gln) amidotransferase subunit C",
Annotation !="Phosphoglucomutase",
Annotation !="Transketolase",
Annotation !="Pyruvate formate-lyase 1-activating enzyme" ,
Annotation !="Ribonucleoside-diphosphate reductase subunit beta nrdF2",
Annotation !="Valine--tRNA ligase")
write_delim(alignmentsFinal, "./aglingmentsFinal.tsv", delim="\t")
gardRelativeAbundance <-  alignmentsFinal %>%
group_by(SampleID) %>%
count(Clade) %>%
mutate(propClade=(n/sum(n)),
Clade=as.character(Clade))
write_delim(gardRelativeAbundance, "./gardRelativeAbundance.tsv", delim="\t")
library(tidyverse)
alignmentsFinal <- read_delim("/Users/hlberman/Documents/GitHub/pregnancy_metagenome/gard_mapping/clade_assignments/gardRelativeAbundance.tsv", delim = "\t")
gardRelativeAbundance <- read_delim("/Users/hlberman/Documents/GitHub/pregnancy_metagenome/gard_mapping/clade_assignments/aglingmentsFinal.tsv", delim = "\t")
sgDF <- read_csv("/Users/hlberman/Documents/GitHub/pregnancy_metagenome/shotgunMetadata.tsv")
metaphlanResults <- load("/Users/hlberman/Documents/GitHub/pregnancy_metagenome/methods_comparisons/PS_RData/metaphlan_PS.RData")
remove(metaphlanResults)
gardRelativeAbundance.tsv <- read_delim("/Users/hlberman/Documents/GitHub/pregnancy_metagenome/gard_mapping/clade_assignments/gardRelativeAbundance.tsv", delim = "\t")
alignmentsFinal <- read_delim("/Users/hlberman/Documents/GitHub/pregnancy_metagenome/gard_mapping/clade_assignments/aglingmentsFinal.tsv", delim = "\t")
sgDF <- read_csv("/Users/hlberman/Documents/GitHub/pregnancy_metagenome/shotgunMetadata.tsv")
load("/Users/hlberman/Documents/GitHub/pregnancy_metagenome/methods_comparisons/PS_RData/metaphlan_PS.RData")
alignmentsFinal <- read_delim("/Users/hlberman/Documents/GitHub/pregnancy_metagenome/gard_mapping/clade_assignments/aglingmentsFinal.tsv", delim = "\t")
gardRelativeAbundance.tsv <- read_delim("/Users/hlberman/Documents/GitHub/pregnancy_metagenome/gard_mapping/clade_assignments/gardRelativeAbundance.tsv", delim = "\t")
gardRelativeAbundance <- read_delim("/Users/hlberman/Documents/GitHub/pregnancy_metagenome/gard_mapping/clade_assignments/gardRelativeAbundance.tsv", delim = "\t")
remove(gardRelativeAbundance.tsv)
View(gardRelativeAbundance)
load("/Users/hlberman/Documents/GitHub/pregnancy_metagenome/methods_comparisons/PS_RData/metaphlan_PS.RData")
metaphlan <- PS_metaphlan_all@otu_table %>%
filter(Genus=="Gardnerella")
metaphlan <- PS_metaphlan_all@otu_table %>%
as.data.frame() #%>%
head(metaphlan)
metaphlan <- PS_metaphlan_all@otu_table %>%
as.data.frame() %>%
t() %>%
select(Gardnerella_vaginalis)
metaphlan <- PS_metaphlan_all@otu_table %>%
as.data.frame() %>%
t() #%>%
head(metaphlan)
metaphlan <- PS_metaphlan_all@otu_table %>%
t() #%>%
head(metaphlan)
metaphlan <- PS_metaphlan_all@otu_table %>%
t() %>%
as.data.frame() %>%
mutate(SubjectID=rownames(.))
head(metaphlan)
metaphlan <- PS_metaphlan_all@otu_table %>%
t() %>%
as.data.frame() %>%
mutate(SubjectID=rownames(.))
metaphlan <- PS_metaphlan_all@otu_table %>%
t() %>%
as.data.frame() %>%
mutate(SubjectID=rownames(.)) %>%
select(Gardnerella_vaginalis, SubjectID)
remove(metaphlan)
metaphlanGard <- PS_metaphlan_all@otu_table %>%
t() %>%
as.data.frame() %>%
mutate(SubjectID=rownames(.)) %>%
select(Gardnerella_vaginalis, SubjectID)
View(metaphlanGard)
VIew(topClade)
View(topClade)
topClade <- gardRelativeAbundance %>%
group_by(SampleID) %>%
filter(propclade=max(propclade))
topClade <- gardRelativeAbundance %>%
group_by(SampleID) %>%
filter(propClade=max(propclade))
topClade <- gardRelativeAbundance %>%
group_by(SampleID) %>%
filter(propClade=max(propClade))
topClade <- gardRelativeAbundance %>%
group_by(SampleID) %>%
filter(propClade==max(propClade))
metaphlanGard <- PS_metaphlan_all@otu_table %>%
t() %>%
as.data.frame() %>%
mutate(SubjectID=rownames(.)) %>%
select(Gardnerella_vaginalis, SubjectID)
abundancexClade <- metaphlanGard %>%
full_join(topClade, by="SampleID")
metaphlanGard <- PS_metaphlan_all@otu_table %>%
t() %>%
as.data.frame() %>%
mutate(SampleID=rownames(.)) %>%
select(Gardnerella_vaginalis, SampleID)
abundancexClade <- metaphlanGard %>%
full_join(topClade, by="SampleID")
metaphlanGard <- PS_metaphlan_all@otu_table %>%
t() %>%
as.data.frame() %>%
mutate(SampleID=rownames(.)) %>%
select(Gardnerella_vaginalis, SampleID)
class(metaphlanGard$SampleID)
topClade <- gardRelativeAbundance %>%
group_by(SampleID) %>%
filter(propClade==max(propClade)) %>%
ungroup() %>%
mutate(SampleID=as.character(SampleID))
metaphlanGard <- PS_metaphlan_all@otu_table %>%
t() %>%
as.data.frame() %>%
mutate(SampleID=rownames(.)) %>%
select(Gardnerella_vaginalis, SampleID)
abundancexClade <- metaphlanGard %>%
full_join(topClade, by="SampleID")
abundancexClade <- metaphlanGard %>%
full_join(topClade, by="SampleID")
View(abundancexClade)
abundancexClade <- metaphlanGard %>%
right_join(topClade, by="SampleID")
ggplot(data = abundancexClade, aes(x=))
ggplot(data = abundancexClade, aes(x=Clade, y=Gardnerella_vaginalis)) +
geom_point() +
geom_boxplot()
ggplot(data = abundancexClade, aes(x=Clade, y=Gardnerella_vaginalis)) +
geom_point()
abundancexClade <- metaphlanGard %>%
left_join(topClade, by="SampleID")
ggplot(data = abundancexClade, aes(x=Clade, y=Gardnerella_vaginalis)) +
geom_point()
abundancexClade <- metaphlanGard %>%
left_join(topClade, by="SampleID") %>%
left_join(sgDF[,c("SampleID", "TermPre")])
abundancexClade <- metaphlanGard %>%
left_join(topClade, by="SampleID") %>%
left_join(sgDF[,c("SampleID", "TermPre")], by="SampleID")
View(sgDF)
sgDF <- read_delim("/Users/hlberman/Documents/GitHub/pregnancy_metagenome/shotgunMetadata.tsv", delim = "\t")
ggplot(data = abundancexClade, aes(x=Clade, y=Gardnerella_vaginalis, color="TermPre")) +
geom_point()
abundancexClade <- metaphlanGard %>%
left_join(topClade, by="SampleID") %>%
left_join(sgDF[,c("SampleID", "TermPre")], by="SampleID")
sgDF <- read_delim("/Users/hlberman/Documents/GitHub/pregnancy_metagenome/shotgunMetadata.tsv", delim = "\t")%>%
mutate(SampleID=as.character(SampleID))
abundancexClade <- metaphlanGard %>%
left_join(topClade, by="SampleID") %>%
left_join(sgDF[,c("SampleID", "TermPre")], by="SampleID")
ggplot(data = abundancexClade, aes(x=Clade, y=Gardnerella_vaginalis, color="TermPre")) +
geom_point()
ggplot(data = abundancexClade, aes(x=Clade, y=Gardnerella_vaginalis, color=TermPre)) +
geom_point()
ggplot(data=abundancexClade, aes(x=Clade, y=propClade))
ggplot(data=abundancexClade, aes(x=Clade, y=propClade))+
geom_point
ggplot(data=abundancexClade, aes(x=Clade, y=propClade))+
geom_point()
ggplot(data = abundancexClade, aes(x=Clade, y=Gardnerella_vaginalis, color=TermPre)) +
geom_point()
ggplot(data=abundancexClade, aes(x=TermPre, y=Gardnerella))
ggplot(data=abundancexClade, aes(x=TermPre, y=Gardnerella, color=TermPre))
ggplot(data=abundancexClade, aes(x=TermPre, y=Gardnerella_vaginalis, color=TermPre)) +
geom_point()
ggplot(data=abundancexClade, aes(x=TermPre, y=Gardnerella_vaginalis, color=Clade)) +
geom_point()
ggplot(data=abundancexClade, aes(x=TermPre, y=Gardnerella_vaginalis, color=as.character(Clade)) +
geom_point()
ggplot(data=abundancexClade, aes(x=TermPre, y=Gardnerella_vaginalis, color=as.character(Clade))) +
ggplot(data=abundancexClade, aes(x=TermPre, y=Gardnerella_vaginalis, color=as.character(Clade))) +
geom_point()
abundancexClade <- metaphlanGard %>%
left_join(topClade, by="SampleID") %>%
left_join(sgDF[,c("SampleID", "TermPre")], by="SampleID")
ggplot(data=abundancexClade, aes(x=Clade, y=propClade))+
geom_point()
ggplot(data = abundancexClade, aes(x=Clade, y=Gardnerella_vaginalis, color=TermPre)) +
geom_point()
ggplot(data=abundancexClade, aes(x=TermPre, y=Gardnerella_vaginalis, color=as.character(Clade))) +
geom_point()
ggplot(data=abundancexClade, aes(x=TermPre, y=Gardnerella_vaginalis, color=as.character(Clade))) +
geom_jitter()
abundancexClade <- metaphlanGard %>%
left_join(topClade, by="SampleID") %>%
left_join(sgDF[,c("SampleID", "TermPre")], by="SampleID")
ggplot(data=abundancexClade, aes(x=Clade, y=propClade))+
geom_point()
ggplot(data = abundancexClade, aes(x=Clade, y=Gardnerella_vaginalis, color=TermPre)) +
geom_point()
ggplot(data=abundancexClade, aes(x=TermPre, y=Gardnerella_vaginalis, color=as.character(Clade))) +
geom_jitter()
ggplot(data=abundancexClade, aes(x=Clade, y=propClade, color=TermPre))+
geom_point()
abundancexClade <- metaphlanGard %>%
left_join(topClade, by="SampleID") %>%
left_join(sgDF[,c("SampleID", "TermPre")], by="SampleID")
ggplot(data=abundancexClade, aes(x=Clade, y=propClade))+
geom_point()
ggplot(data = abundancexClade, aes(x=Clade, y=Gardnerella_vaginalis, color=TermPre)) +
geom_point()
ggplot(data=abundancexClade, aes(x=TermPre, y=Gardnerella_vaginalis, color=as.character(Clade))) +
geom_jitter()
abundancexClade <- metaphlanGard %>%
left_join(topClade, by="SampleID") %>%
left_join(sgDF[,c("SampleID", "TermPre", "SubjectID")], by="SampleID")
ggplot(data=abundancexClade, aes(x=Clade, y=propClade))+
geom_point() %>%
facet_wrap(~SubjectID)
ggplot(data=abundancexClade, aes(x=Clade, y=propClade))+
geom_point() %>%
facet_wrap(~as.character(SubjectID))
abundancexClade <- metaphlanGard %>%
left_join(topClade, by="SampleID") %>%
left_join(sgDF[,c("SampleID", "TermPre", "SubjectID")], by="SampleID")
ggplot(data=abundancexClade, aes(x=Clade, y=propClade))+
geom_point() %>%
facet_wrap(~as.character(SubjectID))
abundancexClade <- metaphlanGard %>%
left_join(topClade, by="SampleID") %>%
left_join(sgDF[,c("SampleID", "TermPre", "SubjectID")], by="SampleID") %>%
mutate(SubjectID=as.character(SubjectID))
ggplot(data=abundancexClade, aes(x=Clade, y=propClade))+
geom_point() %>%
facet_wrap(~SubjectID)
abundancexClade <- metaphlanGard %>%
left_join(topClade, by="SampleID") %>%
left_join(sgDF[,c("SampleID", "TermPre", "SubjectID")], by="SampleID") %>%
mutate(SubjectID=as.character(SubjectID))
ggplot(data=abundancexClade, aes(x=Clade, y=propClade))+
geom_point()
ggplot(data = abundancexClade, aes(x=Clade, y=Gardnerella_vaginalis, color=TermPre)) +
geom_point()
ggplot(data=abundancexClade, aes(x=TermPre, y=Gardnerella_vaginalis, color=as.character(Clade))) +
geom_jitter()
View(topClade)
write_delim(topClade, "./topClades.tsv", delim="\t")
write_delim(sgDF0, "/Users/hlberman/Documents/GitHub/pregnancy_metagenome/shotgunMetadata.tsv", delim = "\t")
sgDF0 <- sgDF %>%
left_join(topClade[,c("SampleID", "Clade")]) %>%
mutate(Clade=topGardClade)
sgDF0 <- sgDF %>%
left_join(topClade[,c("SampleID", "Clade")]) %>%
mutate(Clade=topGardClade)
colnames(sgDF)
write_delim(sgDF0, "/Users/hlberman/Documents/GitHub/pregnancy_metagenome/shotgunMetadata.tsv", delim = "\t")
sgDF0 <- sgDF %>%
left_join(topClade[,c("SampleID", "Clade")], by="SampleID") %>%
mutate(Clade=topGardClade)
sgDF0 <- sgDF %>%
left_join(topClade[,c("SampleID", "Clade")], by="SampleID") %>%
mutate(Clade=topGardClade)
sgDF0 <- sgDF %>%
left_join(topClade[,c("SampleID", "Clade")], by="SampleID") %>%
mutate(Clade=topGardClade)
write_delim(sgDF0, "/Users/hlberman/Documents/GitHub/pregnancy_metagenome/shotgunMetadata.tsv", delim = "\t")
colnames(sgDF)
colnames(topClade)
sgDF0 <- sgDF %>%
left_join(topClade[,c("SampleID", "Clade")], by="SampleID") %>%
mutate(Clade=topGardClade)
sgDF0 <- sgDF %>%
left_join(topClade[,c("SampleID", "Clade")], by="SampleID") %>%
dplyr::rename(topGardClade=Clade)
write_delim(sgDF0, "/Users/hlberman/Documents/GitHub/pregnancy_metagenome/shotgunMetadata.tsv", delim = "\t")
