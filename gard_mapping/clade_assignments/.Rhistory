labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20)) +
scale_x_continuous(breaks = c(0,100,200,300,400))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black") +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20)) +
scale_x_continuous(breaks = c(0,100,200,300,400))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black") +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20)) +
scale_x_continuous(breaks = c(0,100,200,300))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black") +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20)) +
#scale_x_continuous(breaks = c(0,100,200,300))
#ggsave("/Users/hlberman/Desktop/collectionPlot.svg", height=8, width=8.5)
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black") +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black") +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black") +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20)) +
scale_x_continuous(breaks = c(0,50,100,150,200))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black") +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=1.5) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=6) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=1) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=2) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=3) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=4) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=5) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=5) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=10) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=11) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=12) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=13) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=14) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=15) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
scale_x_continuous(breaks = c(0,50,100,150,200))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=15) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20)) +
scale_x_continuous(breaks = c(0,50,100,150,200))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=15) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20)) +
scale_x_continuous(breaks = c(0,50,100,150,200, 250))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=15) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
#theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20)) +
scale_x_continuous(breaks = c(0,50,100,150,200, 250))
ggplot()+
geom_point(mapping = aes(x = allSamples$GDcoll, y = as.character(allSamples$SubjectID)), color = "steelblue") +
geom_point(mapping = aes(x = DFmg$GDcoll, y = as.character(DFmg$SubjectID)), color = "black", size=2, shape=15) +
xlim(0,280) +
labs(x = "Gestation Days",
y = "Subject") +
#theme_classic()+
theme(axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 10),
axis.text.y  = element_blank(),
legend.position = "none",
axis.title.x = element_text(size=20),
axis.title.y = element_text(size=20))
# Directories
repo_dir <- "/Users/hlberman/Documents/GitHub/pregnancy_metagenome/"
gard_tree_dir <- "/Volumes/GoogleDrive/My Drive/Callahan Lab/Gard WGS"
output_dir <- file.path(repo_dir, "gard_mapping/clade_assignments/")
gdrive_path <- "/Volumes/GoogleDrive/My Drive/Callahan Lab/vagMicrobiomeMetagenome/gardMapping/clade_assignments"
# Usearch alignments
usearchAlns <- "/Users/hlberman/mnt/cluster/home/hlberman/VMMG/gard_map/usearch_alns" #path to blast6 tables from usearch alignments
# Gardnerella reference genes
ref_db <- file.path(repo_dir, "gard_mapping/clade_assignments/ref_genes/refGenes.fasta") %>%
readDNAStringSet(); head(ref_db)[1:5]
library(tidyverse)
library(Biostrings); packageVersion("Biostrings")
options(scipen=10000)
# Directories
repo_dir <- "/Users/hlberman/Documents/GitHub/pregnancy_metagenome/"
gard_tree_dir <- "/Volumes/GoogleDrive/My Drive/Callahan Lab/Gard WGS"
output_dir <- file.path(repo_dir, "gard_mapping/clade_assignments/")
gdrive_path <- "/Volumes/GoogleDrive/My Drive/Callahan Lab/vagMicrobiomeMetagenome/gardMapping/clade_assignments"
# Usearch alignments
usearchAlns <- "/Users/hlberman/mnt/cluster/home/hlberman/VMMG/gard_map/usearch_alns" #path to blast6 tables from usearch alignments
# Gardnerella reference genes
ref_db <- file.path(repo_dir, "gard_mapping/clade_assignments/ref_genes/refGenes.fasta") %>%
readDNAStringSet(); head(ref_db)[1:5]
# reference genes annotations
refGenesDF <- file.path(repo_dir, "gard_mapping/clade_assignments/ref_genes/refGenesDF.csv") %>%
read_csv(); head(refGenesDF)
# Gardnerella reference strains metadata
refDF <- file.path(repo_dir, "GardnerellaMetadata.csv") %>%
read_csv(ref_df_path); head(refDF)
# Directories
repo_dir <- "/Users/hlberman/Documents/GitHub/pregnancy_metagenome/"
gard_tree_dir <- "/Volumes/GoogleDrive/My Drive/Callahan Lab/Gard WGS"
output_dir <- file.path(repo_dir, "gard_mapping/clade_assignments/")
gdrive_path <- "/Volumes/GoogleDrive/My Drive/Callahan Lab/vagMicrobiomeMetagenome/gardMapping/clade_assignments"
# Usearch alignments
usearchAlns <- "/Users/hlberman/mnt/cluster/home/hlberman/VMMG/gard_map/usearch_alns" #path to blast6 tables from usearch alignments
# Gardnerella reference genes
ref_db <- file.path(repo_dir, "gard_mapping/clade_assignments/ref_genes/refGenes.fasta") %>%
readDNAStringSet(); head(ref_db)[1:5]
# reference genes annotations
refGenesDF <- file.path(repo_dir, "gard_mapping/clade_assignments/ref_genes/refGenesDF.csv") %>%
read_csv(); head(refGenesDF)
# Gardnerella reference strains metadata
refDF <- file.path(repo_dir, "GardnerellaMetadata.csv") %>%
read_csv(); head(refDF)
# shotgun metadata
sgDF <- file.path(repo_dir, "shotgunMetadata.tsv") %>%
read_delim(delim="\t")
mutate(SampleID=as.character(SampleID),
SubjectID=as.character(SubjectID)); head(sgDF)
# Directories
repo_dir <- "/Users/hlberman/Documents/GitHub/pregnancy_metagenome/"
gard_tree_dir <- "/Volumes/GoogleDrive/My Drive/Callahan Lab/Gard WGS"
output_dir <- file.path(repo_dir, "gard_mapping/clade_assignments/")
gdrive_path <- "/Volumes/GoogleDrive/My Drive/Callahan Lab/vagMicrobiomeMetagenome/gardMapping/clade_assignments"
# Usearch alignments
usearchAlns <- "/Users/hlberman/mnt/cluster/home/hlberman/VMMG/gard_map/usearch_alns" #path to blast6 tables from usearch alignments
# Gardnerella reference genes
ref_db <- file.path(repo_dir, "gard_mapping/clade_assignments/ref_genes/refGenes.fasta") %>%
readDNAStringSet(); head(ref_db)[1:5]
# reference genes annotations
refGenesDF <- file.path(repo_dir, "gard_mapping/clade_assignments/ref_genes/refGenesDF.csv") %>%
read_csv(); head(refGenesDF)
# Gardnerella reference strains metadata
refDF <- file.path(repo_dir, "GardnerellaMetadata.csv") %>%
read_csv(); head(refDF)
# shotgun metadata
sgDF <- file.path(repo_dir, "shotgunMetadata.tsv") %>%
read_delim(delim="\t") %>%
mutate(SampleID=as.character(SampleID),
SubjectID=as.character(SubjectID)); head(sgDF)
# alns <- list.files(usearchAlns, all.files = FALSE, full.names = TRUE) %>%
#   map(read_delim, delim="\t", col_names=c("query", "reference", "pcntid", "length", "mismatch", "gap_open", "qstart", "qend", "rstart", "rend", "evalue", "bitscore")) #read in blast tables
# names(alns) <-  list.files(usearchAlns, all.files = FALSE, full.names = FALSE) %>%
#   str_extract("[0-9]+")
# save(alns, file=file.path(repo_dir, "gard_mapping", "clade_assignments", "alns.Rdata"))
load(file.path(repo_dir, "gard_mapping", "clade_assignments", "alns.Rdata"))
View(refGenesDF)
refDF
View(refDF)
View(refDF)
refDF0 <- refDF %>%
mutate(Clade=paste0("C", Clade))
View(refDF0)
?paste0
refDF0 <- refDF %>%
mutate(Clade=case_when(!is.na(Clade)~paste0("C", Clade),
is.na(Clade)~Clade))
refDF0 <- refDF %>%
mutate(Clade=case_when(!is.na(Clade)~paste0("C", Clade))
View(refDF0)
refDF0 <- refDF %>%
mutate(Clade=case_when(!is.na(Clade)~paste0("C", Clade)))
View(refDF0)
library(tidyverse)
`%!in%` <- Negate(`%in%`)
clade_colors <- scale_color_manual(values=c("salmon", "indianred", "lightblue", "blue3", "darkorchid2", "yellowgreen"), labels=c("C1", "C2", "C3", "C4", "C5", "C6"))
method_colors <- scale_color_manual(values=c("#56B4E9", "#D55E00"))
method_fill <- scale_fill_manual(values=c("#56B4E9", "#D55E00"))
sgDF <- "./shotgunMetadata.tsv" %>%
read_tsv %>%
mutate(SampleID=as.character(SampleID))
uploadGardDF <- "./gard_mapping/clade_assignments/archive/gardRelativeAbundance.tsv" %>%
read_tsv() %>%
mutate(SampleID=as.character(SampleID),
SampleID=case_when(SampleID=="4008434348"~"4008435348",
SampleID!="4008434348"~SampleID))  #typo was still here in previous run, but now fixed to
head(uploadGardDF)
uploadAlns <- load("./gard_mapping/clade_assignments/alns_upload.Rdata")
bbmapGardDF <- "./gard_mapping/clade_assignments/gardRelativeAbundance.tsv" %>%
read_tsv() %>%
mutate(SampleID=as.character(SampleID))
head(bbmapGardDF)
bbmapAlns <- load("./gard_mapping/clade_assignments/alns.Rdata")
uploadAlns
load("./gard_mapping/clade_assignments/alns_upload.Rdata")
remove(uploadAlns)
remove(bbmapAlns)
library(tidyverse)
`%!in%` <- Negate(`%in%`)
clade_colors <- scale_color_manual(values=c("salmon", "indianred", "lightblue", "blue3", "darkorchid2", "yellowgreen"), labels=c("C1", "C2", "C3", "C4", "C5", "C6"))
method_colors <- scale_color_manual(values=c("#56B4E9", "#D55E00"))
method_fill <- scale_fill_manual(values=c("#56B4E9", "#D55E00"))
sgDF <- "./shotgunMetadata.tsv" %>%
read_tsv %>%
mutate(SampleID=as.character(SampleID))
uploadGardDF <- "./gard_mapping/clade_assignments/archive/gardRelativeAbundance.tsv" %>%
read_tsv() %>%
mutate(SampleID=as.character(SampleID),
SampleID=case_when(SampleID=="4008434348"~"4008435348",
SampleID!="4008434348"~SampleID))  #typo was still here in previous run, but now fixed to
head(uploadGardDF)
load("./gard_mapping/clade_assignments/alns_upload.Rdata")
uploadAlns <-alns
remove(alns)
bbmapGardDF <- "./gard_mapping/clade_assignments/gardRelativeAbundance.tsv" %>%
read_tsv() %>%
mutate(SampleID=as.character(SampleID))
head(bbmapGardDF)
load("./gard_mapping/clade_assignments/alns.Rdata")
bbmapAlns <- alns
remove(alns)
View(bbmapAlns$`1000801248`)
bbmapAlns0 <- bbmapAlns %>%
purrr::map(~filter(~pct.id>=99))
bbmapAlns0 <- bbmapAlns %>%
purrr::map(~filter(pct.id>=99))
bbmapAlns0 <- bbmapAlns %>%
purrr::map(~filter(.x$pct.id>=99))
bbmapAlns0 <- bbmapAlns %>%
purrr::map(~filter(pcntid>=99))
bbmapAlns0 <- bbmapAlns %>%
purrr::map(~filter(.x$pcntid>=99))
bbmapAlns0 <- bbmapAlns %>%
purrr::map(~filter(.x, pcntid>=99))
