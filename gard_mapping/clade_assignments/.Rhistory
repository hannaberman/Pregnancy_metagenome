gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(reorder(SampleID, -Abundance, FUN=sum, na.rm=TRUE), TermPre=="T", na.rm=TRUE), , y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "red", "#000000", "#999999"), labels=c("Gardnerella Clade 1", "Gardnerella Clade2", "Gardnerella Clade 3", "Gardnerella Clade 4", "Gardnerella Clade 5", "Gardnerella Clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "red", "#000000", "#999999"), labels=c("Gardnerella Clade 1", "Gardnerella Clade2", "Gardnerella Clade 3", "Gardnerella Clade 4", "Gardnerella Clade 5", "Gardnerella Clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(reorder(SampleID, -Abundance, FUN=sum, na.rm=TRUE), TermPre=="T", na.rm=TRUE), , y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "red", "#000000", "#999999"), labels=c("Gardnerella Clade 1", "Gardnerella Clade2", "Gardnerella Clade 3", "Gardnerella Clade 4", "Gardnerella Clade 5", "Gardnerella Clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "burntsienna", "#000000", "#999999"), labels=c("Gardnerella Clade 1", "Gardnerella Clade2", "Gardnerella Clade 3", "Gardnerella Clade 4", "Gardnerella Clade 5", "Gardnerella Clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(reorder(SampleID, -Abundance, FUN=sum, na.rm=TRUE), TermPre=="T", na.rm=TRUE), , y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "red", "#000000", "#999999"), labels=c("Gardnerella Clade 1", "Gardnerella Clade2", "Gardnerella Clade 3", "Gardnerella Clade 4", "Gardnerella Clade 5", "Gardnerella Clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "indianred", "#000000", "#999999"), labels=c("Gardnerella Clade 1", "Gardnerella Clade2", "Gardnerella Clade 3", "Gardnerella Clade 4", "Gardnerella Clade 5", "Gardnerella Clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(reorder(SampleID, -Abundance, FUN=sum, na.rm=TRUE), TermPre=="T", na.rm=TRUE), , y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "indianred", "#000000", "#999999"), labels=c("Gardnerella Clade 1", "Gardnerella Clade2", "Gardnerella Clade 3", "Gardnerella Clade 4", "Gardnerella Clade 5", "Gardnerella Clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "indianred", "#000000", "#999999"), labels=c("Gardnerella Clade 1", "Gardnerella Clade2", "Gardnerella Clade 3", "Gardnerella Clade 4", "Gardnerella Clade 5", "Gardnerella Clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(reorder(SampleID, -Abundance, FUN=sum, na.rm=TRUE), TermPre=="T", na.rm=TRUE), , y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella Clade 1", "Gardnerella Clade2", "Gardnerella Clade 3", "Gardnerella Clade 4", "Gardnerella Clade 5", "Gardnerella Clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella Clade 1", "Gardnerella Clade2", "Gardnerella Clade 3", "Gardnerella Clade 4", "Gardnerella Clade 5", "Gardnerella Clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(SampleID, -Taxon=="Lactobacillus_crispatus", FUN=sum, na.rm=TRUE), y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(SampleID, Taxon=="Lactobacillus_crispatus", FUN=sum, na.rm=TRUE), y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(SampleID, -Abundance[Taxon=="Lactobacillus_crispatus"], FUN=sum, na.rm=TRUE), y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(SampleID, -Abundance[.$Taxon=="Lactobacillus_crispatus"], FUN=sum, na.rm=TRUE), y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(SampleID, -Abundance[Taxon=="Lactobacillus_crispatus"], na.rm=TRUE), y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
?reorder
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(SampleID, -Abundance[Taxon=="Lactobacillus_crispatus"], FUN=sum(Taxon=="Lactobacillus_crispatus"), na.rm=TRUE), y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(SampleID, -Abundance[Taxon=="Lactobacillus_crispatus"], FUN=sum(Taxon=="Lactobacillus_crispatus"), na.rm=TRUE), y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(SampleID, -Abundance[Taxon=="Lactobacillus_crispatus"], FUN=itentity(), na.rm=TRUE), y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(SampleID, -Abundance[Taxon=="Lactobacillus_crispatus"], FUN=itentity, na.rm=TRUE), y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(SampleID, -Abundance[Taxon=="Lactobacillus_crispatus"], FUN=NULL, na.rm=TRUE), y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(reorder(SampleID, -Abundance, FUN=sum, na.rm=TRUE), TermPre=="T", na.rm=TRUE), , y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(reorder(SampleID, -Abundance, FUN=sum, na.rm=TRUE), TermPre=="T", na.rm=TRUE), , y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank()) +
geom_line(aes(x=reorder(as.numeric(SubjectID), TermPre=="T", na.rm=TRUE), y=0))
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(reorder(SampleID, -Abundance, FUN=sum, na.rm=TRUE), TermPre=="T", na.rm=TRUE), , y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank()) +
geom_line(aes(x=reorder(as.numeric(SubjectID), TermPre=="T", na.rm=TRUE), y=0))
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, Lactobacillus_crispatus, Lactobacillus_gasseri, Lactobacillus_iners, Lactobacillus_jensenii) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(reorder(SampleID, -Abundance, FUN=sum, na.rm=TRUE), TermPre=="T", na.rm=TRUE), , y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, `Lactobacillus crispatus`, `Lactobacillus gasseri`, `Lactobacillus iners`, `Lactobacillus jensenii`) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(reorder(SampleID, -Abundance, FUN=sum, na.rm=TRUE), TermPre=="T", na.rm=TRUE), , y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
LGabundance <- gardRelativeAbundance1 %>%
left_join(mDF[,c("SampleID", "Lactobacillus_crispatus", "Lactobacillus_iners", "Lactobacillus_jensenii", "Lactobacillus_gasseri")], by="SampleID") %>%
gather("Lactobacillus", "LAbundance", c(Lactobacillus_crispatus, Lactobacillus_iners, Lactobacillus_jensenii, Lactobacillus_gasseri)) %>%
mutate(LAbundance=LAbundance/100,
Lactobacillus=case_when(Lactobacillus=="Lactobacillus_crispatus"~"Lactobacillus crispatus",
Lactobacillus=="Lactobacillus_gasseri"~"Lactobacillus gasseri",
Lactobacillus=="Lactobacillus_iners"~"Lactobacillus iners",
Lactobacillus=="Lactobacillus_jensenii"~"Lactobacillus jensenii"))
head(LGabundance)
LGabundance %>%
filter(Cohort=="Stanford") %>%
ggplot(aes(x=propCladeCommunity, y=LAbundance, color=Lactobacillus)) +
geom_point() +
facet_grid(Lactobacillus~Clade) +
#coord_fixed() +
labs(title="Stanford", x="Proportion Gardnerella clade", y="Proportion Lactobacillus")
#ggsave("/Users/hlberman/Desktop/test1.pdf", height = 8, width=15)
LGabundance %>%
filter(Cohort=="UAB") %>%
ggplot(aes(x=propCladeCommunity, y=LAbundance, color=Lactobacillus)) +
geom_point() +
facet_grid(Lactobacillus~Clade) +
#coord_fixed() +
labs(title="UAB", x="Proportion Gardnerella clade", y="Proportion Lactobacillus")
#ggsave("/Users/hlberman/Desktop/test2.pdf", height = 8, width=15)
LGabundance %>%
filter(Cohort=="Stanford") %>%
ggplot(aes(x=(propCladeCommunity == 0), y=LAbundance, color=(propCladeCommunity==0))) +
geom_jitter() +
geom_boxplot(alpha=0) +
scale_color_manual(values=c("#56B4E9", "#D55E00"), labels=c("Present", "Absent")) +
facet_grid(Lactobacillus~Clade) +
labs(title="Stanford", x="Clade presence", y="Total proportion of Lactobacillus")+
scale_x_discrete(labels=c("Present", "Absent")) +
theme(legend.position = "none")
LGabundance %>%
filter(Cohort=="UAB") %>%
ggplot(aes(x=(propCladeCommunity == 0), y=LAbundance, color=(propCladeCommunity==0))) +
geom_jitter() +
geom_boxplot(alpha=0) +
scale_color_manual(values=c("#56B4E9", "#D55E00"), labels=c("Present", "Absent")) +
facet_grid(Lactobacillus~Clade) +
labs(title="UAB", x="Clade presence", y="Total proportion of Lactobacillus")+
scale_x_discrete(labels=c("Present", "Absent")) +
theme(legend.position = "none")
LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, `Lactobacillus crispatus`, `Lactobacillus gasseri`, `Lactobacillus iners`, `Lactobacillus jensenii`) %>%
filter(!is.na(Abundance)) %>%
ggplot(aes(x=reorder(reorder(SampleID, -Abundance, FUN=sum, na.rm=TRUE), TermPre=="T", na.rm=TRUE), , y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
#  geom_line(aes(x=reorder(as.numeric(SubjectID), TermPre=="T", na.rm=TRUE), y=0))
taxAverages %>%
mutate(cladeAvg=na_if(cladeAvg, 0)) %>%
ggplot(mapping=aes(x=reorder(reorder(SubjectID, -cladeAvg, FUN=sum, na.rm=TRUE), TermPre=="T", na.rm=TRUE), y=cladeAvg, fill=Clade, color=Clade)) +
geom_bar(stat = "identity") +
labs(x="Subject", y="Proportion", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", size=5.5, show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", size=5.5, show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", size=5.5, show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
taxAverages <- LGabundance %>%
data.frame(stringsAsFactors=FALSE) %>%
group_by(Taxon, SubjectID) %>%
mutate(taxAvg=mean(Abundance)) %>%
ungroup() %>%
select(SubjectID, Taxon, taxAvg, TermPre, Cohort, GWdell) %>%
unique.data.frame()
LGabundance0 <- LGabundance %>%
select(-n,-propClade) %>%
spread(Clade, propCladeCommunity) %>%
spread(Lactobacillus, LAbundance) %>%
gather("Taxon", "Abundance", `1`, `2`, `3`, `4`, `5`, `6`, `Lactobacillus crispatus`, `Lactobacillus gasseri`, `Lactobacillus iners`, `Lactobacillus jensenii`) %>%
filter(!is.na(Abundance))
ggplot(LGabundance0, aes(x=reorder(reorder(SampleID, -Abundance, FUN=sum, na.rm=TRUE), TermPre=="T", na.rm=TRUE), , y=Abundance, fill=Taxon, color=Taxon)) +
geom_bar(stat="identity") +
labs(x="Sample", y="Proportion of community", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
#  geom_line(aes(x=reorder(as.numeric(SubjectID), TermPre=="T", na.rm=TRUE), y=0))
taxAverages <- LGabundance0 %>%
data.frame(stringsAsFactors=FALSE) %>%
group_by(Taxon, SubjectID) %>%
mutate(taxAvg=mean(Abundance)) %>%
ungroup() %>%
select(SubjectID, Taxon, taxAvg, TermPre, Cohort, GWdell) %>%
unique.data.frame()
taxAverages %>%
mutate(cladeAvg=na_if(cladeAvg, 0)) %>%
ggplot(mapping=aes(x=reorder(reorder(SubjectID, -cladeAvg, FUN=sum, na.rm=TRUE), TermPre=="T", na.rm=TRUE), y=cladeAvg, fill=Clade, color=Clade)) +
geom_bar(stat = "identity") +
labs(x="Subject", y="Proportion", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", size=5.5, show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", size=5.5, show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", size=5.5, show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
taxAverages %>%
mutate(taxAvg=na_if(taxAvg, 0)) %>%
ggplot(mapping=aes(x=reorder(reorder(SubjectID, -taxAvg, FUN=sum, na.rm=TRUE), TermPre=="T", na.rm=TRUE), y=taxAvg, fill=Clade, color=Clade)) +
geom_bar(stat = "identity") +
labs(x="Subject", y="Proportion", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", size=5.5, show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", size=5.5, show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", size=5.5, show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
taxAverages %>%
mutate(taxAvg=na_if(taxAvg, 0)) %>%
ggplot(mapping=aes(x=reorder(reorder(SubjectID, -taxAvg, FUN=sum, na.rm=TRUE), TermPre=="T", na.rm=TRUE), y=taxAvg, fill=Taxon, color=Taxon)) +
geom_bar(stat = "identity") +
labs(x="Subject", y="Proportion", color="Legend", fill="Legend") +
geom_point(aes(y=-.03, color=TermPre, fill=TermPre), shape="square", size=5.5, show.legend = FALSE) +
geom_point(aes(y=-.04, color=TermPre, fill=TermPre), shape="square", size=5.5, show.legend = FALSE) +
geom_point(aes(y=-.05, color=TermPre, fill=TermPre), shape="square", size=5.5, show.legend = FALSE) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
scale_fill_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "darkgreen", "#F0E442", "darkblue", "darkred", "#000000", "#999999"), labels=c("Gardnerella clade 1", "Gardnerella clade2", "Gardnerella clade 3", "Gardnerella clade 4", "Gardnerella clade 5", "Gardnerella clade 6", "Lactobacillus crispatus", "Lactobacillus gasseri", "Lactobacillus iners", "Lactobacillus jensenii", "Preterm", "Term")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())
