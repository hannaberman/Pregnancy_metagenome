scale_color_manual(values=c("#56B4E9", "#D55E00")) +
facet_grid(Cohort~Clade) +
labs(x=element_blank(), y="Proportion clade in community")
ggplot(data=gardRelativeAbundance1, aes(x=TermPre, y=propCladeCommunity, color=TermPre)) +
geom_jitter() +
geom_boxplot(alpha=0) +
ylim(1e-04, 1e04) +
scale_y_log10() +
scale_x_discrete(labels=c("Preterm", "Term")) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
facet_grid(Cohort~Clade) +
labs(x=element_blank(), y="Proportion clade in community")
ggplot(data=gardRelativeAbundance1, aes(x=TermPre, y=propCladeCommunity, color=TermPre)) +
geom_jitter() +
geom_boxplot(alpha=0) +
scale_y_log10(limits=c(1e-04, 1e04)) +
scale_x_discrete(labels=c("Preterm", "Term")) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
facet_grid(Cohort~Clade) +
labs(x=element_blank(), y="Proportion clade in community")
ggplot(data=gardRelativeAbundance1, aes(x=TermPre, y=propCladeCommunity, color=TermPre)) +
geom_jitter() +
geom_boxplot(alpha=0) +
scale_y_log10(limits=c(1e-03, 1e03)) +
scale_x_discrete(labels=c("Preterm", "Term")) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
facet_grid(Cohort~Clade) +
labs(x=element_blank(), y="Proportion clade in community")
gardRelativeAbundance1 %>%
mutate(raioGard=propCladeCommunity/(Gardnerella_vaginalis-propCladeCommunity)) %>%
ggplot(aes(x=Clade, y=raioGard, color=Clade)) +
geom_boxplot(show.legend = FALSE) +
geom_jitter() +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
scale_y_log10(limits=c(1e-03, 1e03)) +
facet_grid(Cohort~.) +
labs(x= "Clade", y= "Gv Clade:Other Clades")
ggplot(data=cladeAverages, aes(x=TermPre, y=cladeAvg, color=TermPre)) +
geom_jitter() +
geom_boxplot(alpha=0)+
scale_x_discrete(labels=c("Preterm", "Term")) +
scale_y_log10(limits=c(1e-03, 1e03)) +
scale_color_manual(values=c("#D55E00", "#56B4E9")) +
facet_grid(Cohort~Clade) +
labs(x=element_blank(), y="Proportion of community") +
theme(legend.position = "none")
LGabundance %>%
filter(Cohort=="Stanford") %>%
ggplot(aes(x=Clade, y=propCladeCommunity/LAbundance, color=Lactobacillus)) +
geom_boxplot() +
geom_jitter() +
facet_grid(Lactobacillus~.) +
scale_color_manual(values=c("darkgreen", "gold3", "darkblue", "darkred")) +
scale_y_log10(limits=c(1e-02, 1e02)) +
labs(title="Stanford", y="G. vaginalis : Lactobacillus sp.")
LGabundance %>%
filter(Cohort=="UAB") %>%
ggplot(aes(x=Clade, y=propCladeCommunity/LAbundance, color=Lactobacillus)) +
geom_boxplot() +
geom_jitter() +
facet_grid(Lactobacillus~.) +
scale_y_log10() +
scale_color_manual(values=c("darkgreen", "gold3", "darkblue", "darkred")) +
labs(title="UAB", y="G. vaginalis : Lactobacillus sp.")
#ggsave("/Users/hlberman/Desktop/test1.pdf", height = 8, width=15)
LGabundance %>%
filter(Cohort=="Stanford") %>%
ggplot(aes(x=Clade, y=propCladeCommunity/LAbundance, color=Lactobacillus)) +
geom_boxplot() +
geom_jitter() +
facet_grid(Lactobacillus~.) +
scale_color_manual(values=c("darkgreen", "gold3", "darkblue", "darkred")) +
scale_y_log10(limits=c(1e-02, 1e02)) +
labs(title="Stanford", y="G. vaginalis : Lactobacillus sp.")
#ggsave("/Users/hlberman/Desktop/test2.pdf", height = 8, width=15)
LGabundance %>%
spread(Lactobacillus, LAbundance) %>%
ggplot(aes(y=(propCladeCommunity/(`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`)), x=(propCladeCommunity+`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
#scale_x_log10() +
scale_y_log10(limits=c(1e-03, 1e03)) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + Lcjg (Frequency)" , y="Gv Clade : Lcjg (Ratio)") +
theme(axis.text.x = element_text(angle=45))
LGabundance %>%
spread(Lactobacillus, LAbundance) %>%
View()
LGabundance %>%
spread(Lactobacillus, LAbundance) %>%
ggplot(aes(y=(propCladeCommunity/`Lactobacillus crispatus`), x=(propCladeCommunity+`Lactobacillus crispatus`), color=Clade, size=n())) +
geom_point() +
facet_grid(Cohort~Clade) +
#scale_x_log10() +
scale_y_log10() +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + L. Crispatus (Frequency)" , y="Gv Clade : L. crispatus (Ratio)")
LGabundance %>%
spread(Lactobacillus, LAbundance) %>%
ggplot(aes(y=(propCladeCommunity/`Lactobacillus crispatus`), x=(propCladeCommunity+`Lactobacillus crispatus`), color=Clade, size=n) +
geom_point() +
facet_grid(Cohort~Clade) +
#scale_x_log10() +
scale_y_log10() +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + L. Crispatus (Frequency)" , y="Gv Clade : L. crispatus (Ratio)")
LGabundance %>%
LGabundance %>%
spread(Lactobacillus, LAbundance) %>%
ggplot(aes(y=(propCladeCommunity/`Lactobacillus crispatus`), x=(propCladeCommunity+`Lactobacillus crispatus`), color=Clade, size=n)) +
geom_point() +
facet_grid(Cohort~Clade) +
#scale_x_log10() +
scale_y_log10() +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + L. Crispatus (Frequency)" , y="Gv Clade : L. crispatus (Ratio)")
LGabundance %>%
spread(Lactobacillus, LAbundance) %>%
ggplot(aes(y=(propCladeCommunity/`Lactobacillus crispatus`), x=(propCladeCommunity+`Lactobacillus crispatus`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
#scale_x_log10() +
scale_y_log10() +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + L. Crispatus (Frequency)" , y="Gv Clade : L. crispatus (Ratio)")
LGabundance %>%
spread(Lactobacillus, LAbundance) %>%
#View()
ggplot(aes(y=(propCladeCommunity/(`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`)), x=(propCladeCommunity+`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
#scale_x_log10() +
scale_y_log10(limits=c(1e-03, 1e03)) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + Lcjg (Frequency)" , y="Gv Clade : Lcjg (Ratio)") +
theme(axis.text.x = element_text(angle=45))
LGabundance %>%
spread(Lactobacillus, LAbundance) %>%
#View()
ggplot(aes(y=(propCladeCommunity/(`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`)), x=(propCladeCommunity+`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`), color=Clade), size=n()) +
geom_point() +
facet_grid(Cohort~Clade) +
#scale_x_log10() +
scale_y_log10(limits=c(1e-03, 1e03)) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + Lcjg (Frequency)" , y="Gv Clade : Lcjg (Ratio)") +
theme(axis.text.x = element_text(angle=45))
LGabundance %>%
spread(Lactobacillus, LAbundance) %>%
ggplot(aes(y=(propCladeCommunity/(`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`)), x=(propCladeCommunity+`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
#scale_x_log10() +
scale_y_log10(limits=c(1e-03, 1e03)) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + Lcjg (Frequency)" , y="Gv Clade : Lcjg (Ratio)") +
theme(axis.text.x = element_text(angle=45))
gardRelativeAbundance1 %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
full_join(GardAb) %>%
LGabundance %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
spread(Lactobacillus, LAbundance) %>%
full_join(GardAb) %>%
ggplot(aes(y=(propCladeCommunity/(`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`)), x=(propCladeCommunity+`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
#scale_x_log10() +
scale_y_log10(limits=c(1e-03, 1e03)) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + Lcjg (Frequency)" , y="Gv Clade : Lcjg (Ratio)") +
theme(axis.text.x = element_text(angle=45))
LGabundance %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
spread(Lactobacillus, LAbundance) %>%
full_join(GardAb) %>%
ggplot(aes(y=(propCladeCommunity/(`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`)), x=(propCladeCommunity+`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
#scale_x_log10() +
scale_y_log10(limits=c(1e-03, 1e03)) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + Lcjg (Frequency)" , y="Gv Clade : Lcjg (Ratio)") +
theme(axis.text.x = element_text(angle=45))
LGabundance %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
spread(Lactobacillus, LAbundance) %>%
full_join(GardAb) %>%
ggplot(aes(y=(propCladeCommunity/(`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`)), x=(propCladeCommunity+`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
#scale_x_log10() +
scale_y_log10(limits=c(1e-03, 1e03)) +
#scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + Lcjg (Frequency)" , y="Gv Clade : Lcjg (Ratio)") +
theme(axis.text.x = element_text(angle=45))
LGabundance %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
spread(Lactobacillus, LAbundance) %>%
full_join(GardAb) %>%
View
ratioFreqTable <- LGabundance %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
spread(Lactobacillus, LAbundance)
GardAb0 <- ratioFreqTable %>%
select(-Clade,-propCladeCommunity,-propClade,-n) %>%
unique.data.frame() %>%
dplyr::rename(propCladeCommunity=Gardnerella_vaginalis) %>%
mutate(Clade="Total Gardnerella")
GardAb0 <- ratioFreqTable %>%
select(-Clade,-propCladeCommunity,-n) %>%
unique.data.frame() %>%
dplyr::rename(propCladeCommunity=Gardnerella_vaginalis) %>%
mutate(Clade="Total Gardnerella")
GardAb0 <- ratioFreqTable %>%
select(-Clade) %>%
unique.data.frame() %>%
dplyr::rename(propCladeCommunity=Gardnerella_vaginalis) %>%
mutate(Clade="Total Gardnerella")
ratioFreqTable <- LGabundance %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
spread(Lactobacillus, LAbundance)
GardAb0 <- ratioFreqTable %>%
select(-Clade) %>%
unique.data.frame() %>%
dplyr::rename(propCladeCommunity=Gardnerella_vaginalis) %>%
mutate(Clade="Total Gardnerella")
ratioFreqTable <- LGabundance %>%
spread(Lactobacillus, LAbundance)
GardAb0 <- ratioFreqTable %>%
select(-Clade) %>%
unique.data.frame() %>%
dplyr::rename(propCladeCommunity=Gardnerella_vaginalis) %>%
mutate(Clade="Total Gardnerella")
ratioFreqTable <- LGabundance %>%
spread(Lactobacillus, LAbundance)
GardAb0 <- ratioFreqTable %>%
select(-Clade) %>%
unique.data.frame() %>%
dplyr::rename(propCladeCommunity=Gardnerella_vaginalis) %>%
mutate(Clade="Total Gardnerella")
GardAb0 <- ratioFreqTable %>%
select(-Clade, -propCladeCommunity, -propClade, -n) %>%
unique.data.frame() %>%
dplyr::rename(propCladeCommunity=Gardnerella_vaginalis) %>%
mutate(Clade="Total Gardnerella")
ratioFreqTable <- LGabundance %>%
spread(Lactobacillus, LAbundance)
GardAb0 <- ratioFreqTable %>%
select(-Clade, -propCladeCommunity, -propClade, -n) %>%
unique.data.frame() %>%
dplyr::rename(propCladeCommunity=Gardnerella_vaginalis) %>%
mutate(Clade="Total Gardnerella")
ratioFreqTable %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
full_join(GardAb0) %>%
View()
ratioFreqTable <- LGabundance %>%
spread(Lactobacillus, LAbundance)
GardAb0 <- ratioFreqTable %>%
select(-Clade, -propCladeCommunity, -propClade, -n) %>%
unique.data.frame() %>%
dplyr::rename(propCladeCommunity=Gardnerella_vaginalis) %>%
mutate(Clade="Total Gardnerella")
ratioFreqTable %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
full_join(GardAb0) %>%
View()
ggplot(aes(y=(propCladeCommunity/(`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`)), x=(propCladeCommunity+`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
#scale_x_log10() +
scale_y_log10(limits=c(1e-03, 1e03)) +
#scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + Lcjg (Frequency)" , y="Gv Clade : Lcjg (Ratio)") +
theme(axis.text.x = element_text(angle=45))
ratioFreqTable %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
full_join(GardAb0) %>%
ggplot(aes(y=(propCladeCommunity/(`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`)), x=(propCladeCommunity+`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
#scale_x_log10() +
scale_y_log10(limits=c(1e-03, 1e03)) +
#scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + Lcjg (Frequency)" , y="Gv Clade : Lcjg (Ratio)") +
theme(axis.text.x = element_text(angle=45))
ratioFreqTable %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
full_join(GardAb0) %>%
ggplot(aes(y=(propCladeCommunity/(`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`)), x=(propCladeCommunity+`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
#scale_x_log10() +
scale_y_log10(limits=c(1e-04, 1e04)) +
#scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + Lcjg (Frequency)" , y="Gv Clade : Lcjg (Ratio)") +
theme(axis.text.x = element_text(angle=45))
ratioFreqTable %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
full_join(GardAb0) %>%
ggplot(aes(y=(propCladeCommunity/(`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`)), x=(propCladeCommunity+`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
scale_y_log10(limits=c(1e-04, 1e04)) +
#scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + Lcjg (Frequency)" , y="Gv Clade : Lcjg (Ratio)") +
theme(axis.text.x = element_text(angle=45))
ratioFreqTable %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
full_join(GardAb0) %>%
ggplot(aes(y=(propCladeCommunity/(`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`)), x=(propCladeCommunity+`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
scale_y_log10(limits=c(1e-03, 1e03)) +
#scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + Lcjg (Frequency)" , y="Gv Clade : Lcjg (Ratio)") +
theme(axis.text.x = element_text(angle=45))
ratioFreqTable %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
full_join(GardAb0) %>%
ggplot(aes(y=(propCladeCommunity/(`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`)), x=(propCladeCommunity+`Lactobacillus crispatus`+`Lactobacillus jensenii`+`Lactobacillus gasseri`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
scale_y_log10(limits=c(1e-03, 1e03)) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "#000000"), labels=c("C1", "C2", "C3", "C4", "C5", "C6", "Total Gardnerella")) +
labs(x="Gv + Lcjg (Frequency)" , y="Gv Clade : Lcjg (Ratio)") +
theme(axis.text.x = element_text(angle=45))
ratioFreqTable %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
full_join(GardAb0) %>%
ggplot(aes(y=(propCladeCommunity/`Lactobacillus crispatus`), x=(propCladeCommunity+`Lactobacillus crispatus`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
scale_y_log10(limits=c(1e-03, 1e03)) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "Total Gardnerella"), labels=c("C1", "C2", "C3", "C4", "C5", "C6")) +
labs(x="Gv + L. Crispatus (Frequency)" , y="Gv Clade : L. crispatus (Ratio)")
ratioFreqTable %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
full_join(GardAb0) %>%
ggplot(aes(y=(propCladeCommunity/`Lactobacillus crispatus`), x=(propCladeCommunity+`Lactobacillus crispatus`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
scale_y_log10(limits=c(1e-03, 1e03)) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "#000000"), labels=c("C1", "C2", "C3", "C4", "C5", "C6", "Total Gardnerella")) +
labs(x="Gv + L. Crispatus (Frequency)" , y="Gv Clade : L. crispatus (Ratio)")
ratioFreqTable %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
full_join(GardAb0) %>%
ggplot(aes(y=(propCladeCommunity/`Lactobacillus jensenii`), x=(propCladeCommunity+`Lactobacillus jensenii`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
#scale_x_log10() +
scale_y_log10() +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "#000000"), labels=c("C1", "C2", "C3", "C4", "C5", "C6", "Total Gardnerella")) +
labs(x="Gv + L. jensenii (Frequency)" , y="Gv Clade : L. jensenii (Ratio)")
ratioFreqTable %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
full_join(GardAb0) %>%
ggplot(aes(y=(propCladeCommunity/`Lactobacillus gasseri`), x=(propCladeCommunity+`Lactobacillus gasseri`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
#scale_x_log10() +
scale_y_log10() +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "#000000"), labels=c("C1", "C2", "C3", "C4", "C5", "C6", "Total Gardnerella")) +
labs(x="Gv + L. gasseri (Frequency)" , y="Gv Clade : L. gasseri (Ratio)")
ratioFreqTable %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
full_join(GardAb0) %>%
ggplot(aes(y=(propCladeCommunity/`Lactobacillus iners`), x=(propCladeCommunity+`Lactobacillus iners`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
scale_y_log10() +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "#000000"), labels=c("C1", "C2", "C3", "C4", "C5", "C6", "Total Gardnerella")) +
labs(x="Gv + L. iners (Frequency)" , y="Gv Clade : L. iners (Ratio)") +
theme(axis.text.x = element_text(angle=45))
ratioFreqTable %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
full_join(GardAb0) %>%
ggplot(aes(y=(propCladeCommunity/`Lactobacillus iners`), x=(propCladeCommunity+`Lactobacillus iners`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
scale_y_log10(limits=c(1e-03, 1e03)) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "#000000"), labels=c("C1", "C2", "C3", "C4", "C5", "C6", "Total Gardnerella")) +
labs(x="Gv + L. iners (Frequency)" , y="Gv Clade : L. iners (Ratio)") +
theme(axis.text.x = element_text(angle=45))
ratioFreqTable %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
full_join(GardAb0) %>%
ggplot(aes(y=(propCladeCommunity/`Lactobacillus gasseri`), x=(propCladeCommunity+`Lactobacillus gasseri`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
scale_y_log10(limits=c(1e-03,1e03)) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "#000000"), labels=c("C1", "C2", "C3", "C4", "C5", "C6", "Total Gardnerella")) +
labs(x="Gv + L. gasseri (Frequency)" , y="Gv Clade : L. gasseri (Ratio)")
ratioFreqTable %>%
select(-Gardnerella_vaginalis, -propClade, -n) %>%
full_join(GardAb0) %>%
ggplot(aes(y=(propCladeCommunity/`Lactobacillus jensenii`), x=(propCladeCommunity+`Lactobacillus jensenii`), color=Clade)) +
geom_point() +
facet_grid(Cohort~Clade) +
scale_y_log10(limits=c(1e-03, 1e03)) +
scale_color_manual(values=c("#CC79A7", "#D55E00", "#56B4E9", "#0072B2", "#E69F00", "#009E73", "#000000"), labels=c("C1", "C2", "C3", "C4", "C5", "C6", "Total Gardnerella")) +
labs(x="Gv + L. jensenii (Frequency)" , y="Gv Clade : L. jensenii (Ratio)")
b <- regDF %>%
.$GReads
library(tidyverse)
library(nnls)
library(glmnet)
#metadata
sgDF <- file.path("..", "shotgunMetadata.tsv") %>%
read_tsv() %>%
mutate(SampleID=as.character(SampleID))
#metaphlan2 data
load(file.path("/Users/hlberman/Documents/GitHub/pregnancy_metagenome/gard_mapping/clade_assignments/metaphlanAbundances.Rdata"))
#subset
sampleSubset <- read_lines(file.path("..", "sampleSubset.txt"))
#humann2 outs
dataDir <- "/Volumes/GoogleDrive/My Drive/Callahan Lab/vagMicrobiomeMetagenome/humann2/out_tables"
GF_path <- file.path(dataDir, "VM_genefamilies_names_cpm.tsv")
# GFP_path <- file.path(dataDir, "VM_genefamilies_paths.tsv")
# GOnames_path <- file.path(dataDir, "map_go_name.txt")
# GFGO_path <- file.path(dataDir, "map_go_uniref90.txt")
# PWnames_path <- file.path(dataDir, "map_metacyc-pwy_name.txt")
# PC_path <- file.path(dataDir, "VM_pathcoverage.tsv")
# PA_path <- file.path(dataDir, "VM_pathabundance.tsv")
# read in data frames
GF <- read_delim(GF_path, delim = "\t") %>% # Gene family abundances
separate(`# Gene Family`, into=c("geneFamily", "org"), sep="\\|", fill="right") %>%
separate(org, into=c("Genus", "Species"), sep="\\.") %>%
mutate(Genus=str_extract(Genus,"[^g__].*$"),
Species=str_extract(Species, "[^s__].*"))
head(GF)
#Species that metaphlan says have no Gard
noGard <- mDF %>%
filter(Gardnerella_vaginalis==0) %>%
select(SampleID) %>%
.[[1]]
gardSamples <- mDF %>%
filter(Gardnerella_vaginalis!=0) %>%
select(SampleID) %>%
.[[1]]
mDFG0 <- mDFG %>%
filter(!is.element(SampleID, noGard)) %>%
mutate(SubjectID=substr(SampleID, 1, 5)) %>%
select(SampleID, SubjectID, contains("Gardnerella")) #%>%
#mutate(gardSum=Gardnerella_vaginalis_C1+Gardnerella_vaginalis_C2+Gardnerella_vaginalis_C3+Gardnerella_vaginalis_C4+Gardnerella_vaginalis_C5+Gardnerella_vaginalis_C6) %>%
#mutate_at(vars(Gardnerella_vaginalis_C1,Gardnerella_vaginalis_C2,Gardnerella_vaginalis_C3,Gardnerella_vaginalis_C4,Gardnerella_vaginalis_C5,Gardnerella_vaginalis_C6), ~.x/gardSum)
head(mDFG0)
class(mDFG0$Gardnerella_vaginalis_C6)
mDFG0 %>%
select(contains("Gardnerella")) %>%
rowSums()
# Obtain Gardnerella-only genes
gvGF <- GF %>%
dplyr::rename_all(~str_extract(.x, "geneFamily|Genus|Species|[0-9]{10}")) %>%
filter(Genus=="Gardnerella") %>%
select(-Genus, -Species, -one_of(noGard))
head(gvGF)
# GFP <- read_delim(GFP_path, delim = "\t") # pathways for each gene family
# PWnames <- read_delim(PWnames_path, delim = "\t", col_names = c("Pathway", "pathwayAnnotation"))
# PC <- read_delim(PC_path, delim = "\t") # pathway coverage
# PA <- read_delim(PA_path, delim = "\t") # pathway abundnance
# GOnames <- read_delim(GOnames_path, delim = "\t", col_names = c("GO", "Function")) # names and annotations of GO categories
# GFGO <- read_lines(GFGO_path) %>% # read in the file as a list
#   str_split("\t")
gvGF0 <- gvGF %>%
filter(str_detect(geneFamily, "E3D7F6")) %>%
rbind(colnames(gvGF)) %>%
t() %>%
as.data.frame() %>%
filter(V2!="geneFamily") %>%
dplyr::rename(E3D7F6=V1,
SampleID=V2) %>%
mutate(E3D7F6=as.numeric(as.character(E3D7F6)),
SampleID=as.character(SampleID)) %>%
select(SampleID, E3D7F6)
head(gvGF0)
GDF <- gvGF %>%
filter(str_detect(geneFamily, "SecY|ribosomal protein S12| Ribosomal protein S7|ribosomal protein L5|ribosomal protein L11")) %>%
rbind(colnames(gvGF)) %>%
t() %>%
as.data.frame() %>%
slice(2:nrow(.)) %>%
gather("refGene", "rpk", c(1:5)) %>%
mutate(rpk=as.numeric(as.character(rpk))) %>%
dplyr::rename(SampleID=V6) %>%
group_by(SampleID) %>%
summarise(refG=sum(rpk))
regDF <- mDFG0 %>%
left_join(gvGF0, by="SampleID") %>%
left_join(GDF, by="SampleID") %>%
mutate(Ginv=refG/1,
Greads=E3D7F6/refG)
head(regDF)
glm(data=regDF, E3D7F6~SubjectID+Gardnerella_vaginalis_C1*refG+Gardnerella_vaginalis_C2*refG+Gardnerella_vaginalis_C3*refG+Gardnerella_vaginalis_C4*refG+Gardnerella_vaginalis_C5*refG+Gardnerella_vaginalis_C6*refG) %>%
summary()
glm(data=regDF, Greads~SubjectID+Gardnerella_vaginalis_C1+Gardnerella_vaginalis_C2+Gardnerella_vaginalis_C3+Gardnerella_vaginalis_C4+Gardnerella_vaginalis_C5+Gardnerella_vaginalis_C6) %>%
summary()
b <- regDF %>%
.$GReads
b <- regDF %>%
.$GReads
View(regDF)
b <- regDF %>%
.[,"Greads"]
A <- regDF %>%
select(SubjectID, `Gardnerella_vaginalis_C1`,`Gardnerella_vaginalis_C2`,`Gardnerella_vaginalis_C3`,`Gardnerella_vaginalis_C4`,`Gardnerella_vaginalis_C5`,`Gardnerella_vaginalis_C6`) %>%
as.matrix()
test <- glmnet(A,b, family="gaussian", alpha = 1)
plot(test, xvar="lambda", label=TRUE)
nnls(A, b)
